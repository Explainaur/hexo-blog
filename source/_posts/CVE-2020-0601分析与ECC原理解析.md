---
title: CVE-2020-0601分析与ECC原理解析
date: 2020-01-19 16:41:40
tags:
    - thinking
---

## 前言
&emsp;&emsp;近日NSA向微软公布了一个基于ECC加密的漏洞(CVE-2020-0601)，该漏洞出现于Windows CryptoAPI(Crypt32.dll)做签名验证的部分，该漏洞可能导致严重的威胁。下面我们来分析一下这个漏洞

## ECC原理介绍
&emsp;&emsp;首先我们来学习一下ECC(椭圆曲线加密)的原理。ECC全称为“Ellipse Curve Ctyptography”，是一种基于椭圆曲线数学的公开密钥加密算法。椭圆曲线在密码学中的使用是在1985年由Neal Koblitz和Victor Miller分别独立提出的。与传统的基于大质数分解难题的加密算法不同，该加密方式基于 “**离散对数**” 这种数学难题。该算法的主要优势是可以使用更小的密钥病提供相当高等级的安全。ECC164位的密钥产生一个安全级，相当于RSA 1024位密钥提供的保密强度，而且计算量较小，处理速度更快，存储空间和传输带宽占用较少。目前我国居民二代身份证正在使用 256 位的椭圆曲线密码，虚拟货币比特币也选择ECC作为加密算法。

### 数学基础

> **以下内容我们小学二年级就学过，带领大家复习一下**

![math](https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/math.jpeg?raw=true)

&emsp;&emsp;首先我们来介绍一下**射影**。传统的几何几何系统中，我们可以在《几何原本》中照到如下定理：

- 由任意一点到任意一点可作直线。
- 一条有限线段可以无限延长
- 凡直角皆相等
- 三角形内角和为180度
- 同一平面内一条直线a和另外两条直线b.c相交，若在a某一侧的两个内角的和小于两直角，则b.c两直线经无限延长后在该侧相交

![tran](https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/tran.png?raw=true)

&emsp;&emsp;以上内容属于欧式几何，然后又一些大佬觉得欧几里得说的不对，他们觉得第五条定理不能作为公理，而且三角形的内角和也不是180度。所以，有些强者就建立了新的几何体系，比如，俄国的罗巴切夫斯基提出“至少可以找到两条相异的直线，且都通过P点，并不与直线R相交”代替第五公设，然后与欧氏几何的四个公设结合成一个公理系统，简称“罗氏几何(双曲几何)”。黎曼大佬也插了一脚，他觉得“找不到一条直线可以通过P点，并且不与直线R相交”，于是建立了黎曼几何(椭圆几何).数学就是这样神奇，只要你能自圆其说，满足自洽性，你也能建立自己的体系。

![geo](https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/geo.png?raw=true)

&emsp;&emsp;我们把上面的两种几何体系称之为非欧几何。定义平行线相交于无穷远点P∞，使平面上所有直线都统一为有唯一的交点，那么：

- 一条直线只有一个无穷远点；一对平行线有公共的无穷远点
- 任何两条直线有不同的无穷远点
- 平面上的无穷远点构成的集合组成一条无穷远直线

> **射影平面**可被认为是个具有额外的“***无穷远点***”之一般平面，平行线会于该点相交。因此，在射影平面上的两条线会相交于一个且仅一个点。

#### 椭圆曲线

---

&emsp;&emsp;**椭圆曲线**就是在射影平面上满足魏尔斯特拉斯方程(Weierstrass)的点构成曲线。对于有限域上的椭圆曲线，一般我们用如下方程定义：

![equation](data:image/svg+xml;base64,PHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjE2%0D%0ALjkzNWV4IiBoZWlnaHQ9IjMuMDA5ZXgiIHN0eWxlPSJ2ZXJ0aWNhbC1hbGlnbjogLTAuNjcxZXg7%0D%0AIiB2aWV3Qm94PSIwIC0xMDA2LjYgNzI5MS40IDEyOTUuNyIgcm9sZT0iaW1nIiBmb2N1c2FibGU9%0D%0AImZhbHNlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGFyaWEtbGFiZWxsZWRi%0D%0AeT0iTWF0aEpheC1TVkctMS1UaXRsZSI+Cjx0aXRsZSBpZD0iTWF0aEpheC1TVkctMS1UaXRsZSI+%0D%0Ae1xkaXNwbGF5c3R5bGUgeV57Mn09eF57M30rYXgrYn08L3RpdGxlPgo8ZGVmcyBhcmlhLWhpZGRl%0D%0Abj0idHJ1ZSI+CjxwYXRoIHN0cm9rZS13aWR0aD0iMSIgaWQ9IkUxLU1KTUFUSEktNzkiIGQ9Ik0y%0D%0AMSAyODdRMjEgMzAxIDM2IDMzNVQ4NCA0MDZUMTU4IDQ0MlExOTkgNDQyIDIyNCA0MTlUMjUwIDM1%0D%0ANVEyNDggMzM2IDI0NyAzMzRRMjQ3IDMzMSAyMzEgMjg4VDE5OCAxOTFUMTgyIDEwNVExODIgNjIg%0D%0AMTk2IDQ1VDIzOCAyN1EyNjEgMjcgMjgxIDM4VDMxMiA2MVQzMzkgOTRRMzM5IDk1IDM0NCAxMTRU%0D%0AMzU4IDE3M1QzNzcgMjQ3UTQxNSAzOTcgNDE5IDQwNFE0MzIgNDMxIDQ2MiA0MzFRNDc1IDQzMSA0%0D%0AODMgNDI0VDQ5NCA0MTJUNDk2IDQwM1E0OTYgMzkwIDQ0NyAxOTNUMzkxIC0yM1EzNjMgLTEwNiAy%0D%0AOTQgLTE1NVQxNTYgLTIwNVExMTEgLTIwNSA3NyAtMTgzVDQzIC0xMTdRNDMgLTk1IDUwIC04MFQ2%0D%0AOSAtNThUODkgLTQ4VDEwNiAtNDVRMTUwIC00NSAxNTAgLTg3UTE1MCAtMTA3IDEzOCAtMTIyVDEx%0D%0ANSAtMTQyVDEwMiAtMTQ3TDk5IC0xNDhRMTAxIC0xNTMgMTE4IC0xNjBUMTUyIC0xNjdIMTYwUTE3%0D%0ANyAtMTY3IDE4NiAtMTY1UTIxOSAtMTU2IDI0NyAtMTI3VDI5MCAtNjVUMzEzIC05VDMyMSAyMUwz%0D%0AMTUgMTdRMzA5IDEzIDI5NiA2VDI3MCAtNlEyNTAgLTExIDIzMSAtMTFRMTg1IC0xMSAxNTAgMTFU%0D%0AMTA0IDgyUTEwMyA4OSAxMDMgMTEzUTEwMyAxNzAgMTM4IDI2MlQxNzMgMzc5UTE3MyAzODAgMTcz%0D%0AIDM4MVExNzMgMzkwIDE3MyAzOTNUMTY5IDQwMFQxNTggNDA0SDE1NFExMzEgNDA0IDExMiAzODVU%0D%0AODIgMzQ0VDY1IDMwMlQ1NyAyODBRNTUgMjc4IDQxIDI3OEgyN1EyMSAyODQgMjEgMjg3WiI+PC9w%0D%0AYXRoPgo8cGF0aCBzdHJva2Utd2lkdGg9IjEiIGlkPSJFMS1NSk1BSU4tMzIiIGQ9Ik0xMDkgNDI5%0D%0AUTgyIDQyOSA2NiA0NDdUNTAgNDkxUTUwIDU2MiAxMDMgNjE0VDIzNSA2NjZRMzI2IDY2NiAzODcg%0D%0ANjEwVDQ0OSA0NjVRNDQ5IDQyMiA0MjkgMzgzVDM4MSAzMTVUMzAxIDI0MVEyNjUgMjEwIDIwMSAx%0D%0ANDlMMTQyIDkzTDIxOCA5MlEzNzUgOTIgMzg1IDk3UTM5MiA5OSA0MDkgMTg2VjE4OUg0NDlWMTg2%0D%0AUTQ0OCAxODMgNDM2IDk1VDQyMSAzVjBINTBWMTlWMzFRNTAgMzggNTYgNDZUODYgODFRMTE1IDEx%0D%0AMyAxMzYgMTM3UTE0NSAxNDcgMTcwIDE3NFQyMDQgMjExVDIzMyAyNDRUMjYxIDI3OFQyODQgMzA4%0D%0AVDMwNSAzNDBUMzIwIDM2OVQzMzMgNDAxVDM0MCA0MzFUMzQzIDQ2NFEzNDMgNTI3IDMwOSA1NzNU%0D%0AMjEyIDYxOVExNzkgNjE5IDE1NCA2MDJUMTE5IDU2OVQxMDkgNTUwUTEwOSA1NDkgMTE0IDU0OVEx%0D%0AMzIgNTQ5IDE1MSA1MzVUMTcwIDQ4OVExNzAgNDY0IDE1NCA0NDdUMTA5IDQyOVoiPjwvcGF0aD4K%0D%0APHBhdGggc3Ryb2tlLXdpZHRoPSIxIiBpZD0iRTEtTUpNQUlOLTNEIiBkPSJNNTYgMzQ3UTU2IDM2%0D%0AMCA3MCAzNjdINzA3UTcyMiAzNTkgNzIyIDM0N1E3MjIgMzM2IDcwOCAzMjhMMzkwIDMyN0g3MlE1%0D%0ANiAzMzIgNTYgMzQ3Wk01NiAxNTNRNTYgMTY4IDcyIDE3M0g3MDhRNzIyIDE2MyA3MjIgMTUzUTcy%0D%0AMiAxNDAgNzA3IDEzM0g3MFE1NiAxNDAgNTYgMTUzWiI+PC9wYXRoPgo8cGF0aCBzdHJva2Utd2lk%0D%0AdGg9IjEiIGlkPSJFMS1NSk1BVEhJLTc4IiBkPSJNNTIgMjg5UTU5IDMzMSAxMDYgMzg2VDIyMiA0%0D%0ANDJRMjU3IDQ0MiAyODYgNDI0VDMyOSAzNzlRMzcxIDQ0MiA0MzAgNDQyUTQ2NyA0NDIgNDk0IDQy%0D%0AMFQ1MjIgMzYxUTUyMiAzMzIgNTA4IDMxNFQ0ODEgMjkyVDQ1OCAyODhRNDM5IDI4OCA0MjcgMjk5%0D%0AVDQxNSAzMjhRNDE1IDM3NCA0NjUgMzkxUTQ1NCA0MDQgNDI1IDQwNFE0MTIgNDA0IDQwNiA0MDJR%0D%0AMzY4IDM4NiAzNTAgMzM2UTI5MCAxMTUgMjkwIDc4UTI5MCA1MCAzMDYgMzhUMzQxIDI2UTM3OCAy%0D%0ANiA0MTQgNTlUNDYzIDE0MFE0NjYgMTUwIDQ2OSAxNTFUNDg1IDE1M0g0ODlRNTA0IDE1MyA1MDQg%0D%0AMTQ1UTUwNCAxNDQgNTAyIDEzNFE0ODYgNzcgNDQwIDMzVDMzMyAtMTFRMjYzIC0xMSAyMjcgNTJR%0D%0AMTg2IC0xMCAxMzMgLTEwSDEyN1E3OCAtMTAgNTcgMTZUMzUgNzFRMzUgMTAzIDU0IDEyM1Q5OSAx%0D%0ANDNRMTQyIDE0MyAxNDIgMTAxUTE0MiA4MSAxMzAgNjZUMTA3IDQ2VDk0IDQxTDkxIDQwUTkxIDM5%0D%0AIDk3IDM2VDExMyAyOVQxMzIgMjZRMTY4IDI2IDE5NCA3MVEyMDMgODcgMjE3IDEzOVQyNDUgMjQ3%0D%0AVDI2MSAzMTNRMjY2IDM0MCAyNjYgMzUyUTI2NiAzODAgMjUxIDM5MlQyMTcgNDA0UTE3NyA0MDQg%0D%0AMTQyIDM3MlQ5MyAyOTBROTEgMjgxIDg4IDI4MFQ3MiAyNzhINThRNTIgMjg0IDUyIDI4OVoiPjwv%0D%0AcGF0aD4KPHBhdGggc3Ryb2tlLXdpZHRoPSIxIiBpZD0iRTEtTUpNQUlOLTMzIiBkPSJNMTI3IDQ2%0D%0AM1ExMDAgNDYzIDg1IDQ4MFQ2OSA1MjRRNjkgNTc5IDExNyA2MjJUMjMzIDY2NVEyNjggNjY1IDI3%0D%0ANyA2NjRRMzUxIDY1MiAzOTAgNjExVDQzMCA1MjJRNDMwIDQ3MCAzOTYgNDIxVDMwMiAzNTBMMjk5%0D%0AIDM0OFEyOTkgMzQ3IDMwOCAzNDVUMzM3IDMzNlQzNzUgMzE1UTQ1NyAyNjIgNDU3IDE3NVE0NTcg%0D%0AOTYgMzk1IDM3VDIzOCAtMjJRMTU4IC0yMiAxMDAgMjFUNDIgMTMwUTQyIDE1OCA2MCAxNzVUMTA1%0D%0AIDE5M1ExMzMgMTkzIDE1MSAxNzVUMTY5IDEzMFExNjkgMTE5IDE2NiAxMTBUMTU5IDk0VDE0OCA4%0D%0AMlQxMzYgNzRUMTI2IDcwVDExOCA2N0wxMTQgNjZRMTY1IDIxIDIzOCAyMVEyOTMgMjEgMzIxIDc0%0D%0AUTMzOCAxMDcgMzM4IDE3NVYxOTVRMzM4IDI5MCAyNzQgMzIyUTI1OSAzMjggMjEzIDMyOUwxNzEg%0D%0AMzMwTDE2OCAzMzJRMTY2IDMzNSAxNjYgMzQ4UTE2NiAzNjYgMTc0IDM2NlEyMDIgMzY2IDIzMiAz%0D%0ANzFRMjY2IDM3NiAyOTQgNDEzVDMyMiA1MjVWNTMzUTMyMiA1OTAgMjg3IDYxMlEyNjUgNjI2IDI0%0D%0AMCA2MjZRMjA4IDYyNiAxODEgNjE1VDE0MyA1OTJUMTMyIDU4MEgxMzVRMTM4IDU3OSAxNDMgNTc4%0D%0AVDE1MyA1NzNUMTY1IDU2NlQxNzUgNTU1VDE4MyA1NDBUMTg2IDUyMFExODYgNDk4IDE3MiA0ODFU%0D%0AMTI3IDQ2M1oiPjwvcGF0aD4KPHBhdGggc3Ryb2tlLXdpZHRoPSIxIiBpZD0iRTEtTUpNQUlOLTJC%0D%0AIiBkPSJNNTYgMjM3VDU2IDI1MFQ3MCAyNzBIMzY5VjQyMEwzNzAgNTcwUTM4MCA1ODMgMzg5IDU4%0D%0AM1E0MDIgNTgzIDQwOSA1NjhWMjcwSDcwN1E3MjIgMjYyIDcyMiAyNTBUNzA3IDIzMEg0MDlWLTY4%0D%0AUTQwMSAtODIgMzkxIC04MkgzODlIMzg3UTM3NSAtODIgMzY5IC02OFYyMzBINzBRNTYgMjM3IDU2%0D%0AIDI1MFoiPjwvcGF0aD4KPHBhdGggc3Ryb2tlLXdpZHRoPSIxIiBpZD0iRTEtTUpNQVRISS02MSIg%0D%0AZD0iTTMzIDE1N1EzMyAyNTggMTA5IDM0OVQyODAgNDQxUTMzMSA0NDEgMzcwIDM5MlEzODYgNDIy%0D%0AIDQxNiA0MjJRNDI5IDQyMiA0MzkgNDE0VDQ0OSAzOTRRNDQ5IDM4MSA0MTIgMjM0VDM3NCA2OFEz%0D%0ANzQgNDMgMzgxIDM1VDQwMiAyNlE0MTEgMjcgNDIyIDM1UTQ0MyA1NSA0NjMgMTMxUTQ2OSAxNTEg%0D%0ANDczIDE1MlE0NzUgMTUzIDQ4MyAxNTNINDg3UTUwNiAxNTMgNTA2IDE0NFE1MDYgMTM4IDUwMSAx%0D%0AMTdUNDgxIDYzVDQ0OSAxM1E0MzYgMCA0MTcgLThRNDA5IC0xMCAzOTMgLTEwUTM1OSAtMTAgMzM2%0D%0AIDVUMzA2IDM2TDMwMCA1MVEyOTkgNTIgMjk2IDUwUTI5NCA0OCAyOTIgNDZRMjMzIC0xMCAxNzIg%0D%0ALTEwUTExNyAtMTAgNzUgMzBUMzMgMTU3Wk0zNTEgMzI4UTM1MSAzMzQgMzQ2IDM1MFQzMjMgMzg1%0D%0AVDI3NyA0MDVRMjQyIDQwNSAyMTAgMzc0VDE2MCAyOTNRMTMxIDIxNCAxMTkgMTI5UTExOSAxMjYg%0D%0AMTE5IDExOFQxMTggMTA2UTExOCA2MSAxMzYgNDRUMTc5IDI2UTIxNyAyNiAyNTQgNTlUMjk4IDEx%0D%0AMFEzMDAgMTE0IDMyNSAyMTdUMzUxIDMyOFoiPjwvcGF0aD4KPHBhdGggc3Ryb2tlLXdpZHRoPSIx%0D%0AIiBpZD0iRTEtTUpNQVRISS02MiIgZD0iTTczIDY0N1E3MyA2NTcgNzcgNjcwVDg5IDY4M1E5MCA2%0D%0AODMgMTYxIDY4OFQyMzQgNjk0UTI0NiA2OTQgMjQ2IDY4NVQyMTIgNTQyUTIwNCA1MDggMTk1IDQ3%0D%0AMlQxODAgNDE4TDE3NiAzOTlRMTc2IDM5NiAxODIgNDAyUTIzMSA0NDIgMjgzIDQ0MlEzNDUgNDQy%0D%0AIDM4MyAzOTZUNDIyIDI4MFE0MjIgMTY5IDM0MyA3OVQxNzMgLTExUTEyMyAtMTEgODIgMjdUNDAg%0D%0AMTUwVjE1OVE0MCAxODAgNDggMjE3VDk3IDQxNFExNDcgNjExIDE0NyA2MjNUMTA5IDYzN1ExMDQg%0D%0ANjM3IDEwMSA2MzdIOTZRODYgNjM3IDgzIDYzN1Q3NiA2NDBUNzMgNjQ3Wk0zMzYgMzI1VjMzMVEz%0D%0AMzYgNDA1IDI3NSA0MDVRMjU4IDQwNSAyNDAgMzk3VDIwNyAzNzZUMTgxIDM1MlQxNjMgMzMwTDE1%0D%0ANyAzMjJMMTM2IDIzNlExMTQgMTUwIDExNCAxMTRRMTE0IDY2IDEzOCA0MlExNTQgMjYgMTc4IDI2%0D%0AUTIxMSAyNiAyNDUgNThRMjcwIDgxIDI4NSAxMTRUMzE4IDIxOVEzMzYgMjkxIDMzNiAzMjVaIj48%0D%0AL3BhdGg+CjwvZGVmcz4KPGcgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIGZpbGw9ImN1cnJlbnRDb2xv%0D%0AciIgc3Ryb2tlLXdpZHRoPSIwIiB0cmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDApIiBhcmlh%0D%0ALWhpZGRlbj0idHJ1ZSI+CiA8dXNlIHhsaW5rOmhyZWY9IiNFMS1NSk1BVEhJLTc5IiB4PSIwIiB5%0D%0APSIwIj48L3VzZT4KIDx1c2UgdHJhbnNmb3JtPSJzY2FsZSgwLjcwNykiIHhsaW5rOmhyZWY9IiNF%0D%0AMS1NSk1BSU4tMzIiIHg9IjcwNiIgeT0iNTgzIj48L3VzZT4KIDx1c2UgeGxpbms6aHJlZj0iI0Ux%0D%0ALU1KTUFJTi0zRCIgeD0iMTIzMSIgeT0iMCI+PC91c2U+CjxnIHRyYW5zZm9ybT0idHJhbnNsYXRl%0D%0AKDIyODcsMCkiPgogPHVzZSB4bGluazpocmVmPSIjRTEtTUpNQVRISS03OCIgeD0iMCIgeT0iMCI+%0D%0APC91c2U+CiA8dXNlIHRyYW5zZm9ybT0ic2NhbGUoMC43MDcpIiB4bGluazpocmVmPSIjRTEtTUpN%0D%0AQUlOLTMzIiB4PSI4MDkiIHk9IjU4MyI+PC91c2U+CjwvZz4KIDx1c2UgeGxpbms6aHJlZj0iI0Ux%0D%0ALU1KTUFJTi0yQiIgeD0iMzUzNiIgeT0iMCI+PC91c2U+CiA8dXNlIHhsaW5rOmhyZWY9IiNFMS1N%0D%0ASk1BVEhJLTYxIiB4PSI0NTM2IiB5PSIwIj48L3VzZT4KIDx1c2UgeGxpbms6aHJlZj0iI0UxLU1K%0D%0ATUFUSEktNzgiIHg9IjUwNjYiIHk9IjAiPjwvdXNlPgogPHVzZSB4bGluazpocmVmPSIjRTEtTUpN%0D%0AQUlOLTJCIiB4PSI1ODYxIiB5PSIwIj48L3VzZT4KIDx1c2UgeGxpbms6aHJlZj0iI0UxLU1KTUFU%0D%0ASEktNjIiIHg9IjY4NjEiIHk9IjAiPjwvdXNlPgo8L2c+Cjwvc3ZnPg==)

&emsp;&emsp;其图像一般如下：

![curve](data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxz%0D%0AdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxu%0D%0AczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6%0D%0ALy93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0%0D%0AcDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAw%0D%0AL3N2ZyIKICAgdmVyc2lvbj0iMS4wIgogICB3aWR0aD0iMzM1IgogICBoZWlnaHQ9IjE5MCIKICAg%0D%0AaWQ9InN2ZzIiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxtYXJrZXIKICAgICAgIHJl%0D%0AZlg9IjAiCiAgICAgICByZWZZPSIwIgogICAgICAgb3JpZW50PSJhdXRvIgogICAgICAgaWQ9IkFy%0D%0Acm93MU1lbmQiCiAgICAgICBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZSI+CiAgICAgIDxwYXRoCiAg%0D%0AICAgICAgIGQ9Ik0gMCwwIDUsLTUgLTEyLjUsMCA1LDUgMCwwIHoiCiAgICAgICAgIHRyYW5zZm9y%0D%0AbT0ibWF0cml4KC0wLjQsMCwwLC0wLjQsLTQsMCkiCiAgICAgICAgIGlkPSJwYXRoNDE0NiIKICAg%0D%0AICAgICAgc3R5bGU9ImZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0%0D%0AaDoxcHQ7bWFya2VyLXN0YXJ0Om5vbmUiIC8+CiAgICA8L21hcmtlcj4KICAgIDxtYXJrZXIKICAg%0D%0AICAgIHJlZlg9IjAiCiAgICAgICByZWZZPSIwIgogICAgICAgb3JpZW50PSJhdXRvIgogICAgICAg%0D%0AaWQ9IkFycm93MkxlbmQiCiAgICAgICBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZSI+CiAgICAgIDxw%0D%0AYXRoCiAgICAgICAgIGQ9Ik0gOC43MTg1ODc4LDQuMDMzNzM1MiAtMi4yMDcyODk1LDAuMDE2MDEz%0D%0AMjYgOC43MTg1ODg0LC00LjAwMTcwNzggYyAtMS43NDU0OTg0LDIuMzcyMDYwOSAtMS43MzU0NDA4%0D%0ALDUuNjE3NDUxOSAtNmUtNyw4LjAzNTQ0MyB6IgogICAgICAgICB0cmFuc2Zvcm09Im1hdHJpeCgt%0D%0AMS4xLDAsMCwtMS4xLC0xLjEsMCkiCiAgICAgICAgIGlkPSJwYXRoNDE1OCIKICAgICAgICAgc3R5%0D%0AbGU9ImZvbnQtc2l6ZToxMnB4O2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZS13aWR0aDowLjYyNTtz%0D%0AdHJva2UtbGluZWpvaW46cm91bmQiIC8+CiAgICA8L21hcmtlcj4KICAgIDxtYXJrZXIKICAgICAg%0D%0AIHJlZlg9IjAiCiAgICAgICByZWZZPSIwIgogICAgICAgb3JpZW50PSJhdXRvIgogICAgICAgaWQ9%0D%0AIlRyaWFuZ2xlSW5MIgogICAgICAgc3R5bGU9Im92ZXJmbG93OnZpc2libGUiPgogICAgICA8cGF0%0D%0AaAogICAgICAgICBkPSJtIDUuNzcsMCAtOC42NSw1IDAsLTEwIDguNjUsNSB6IgogICAgICAgICB0%0D%0AcmFuc2Zvcm09InNjYWxlKC0wLjgsLTAuOCkiCiAgICAgICAgIGlkPSJwYXRoNDIyNiIKICAgICAg%0D%0AICAgc3R5bGU9ImZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDox%0D%0AcHQ7bWFya2VyLXN0YXJ0Om5vbmUiIC8+CiAgICA8L21hcmtlcj4KICAgIDxtYXJrZXIKICAgICAg%0D%0AIHJlZlg9IjAiCiAgICAgICByZWZZPSIwIgogICAgICAgb3JpZW50PSJhdXRvIgogICAgICAgaWQ9%0D%0AIkFycm93MU1zdGFydCIKICAgICAgIHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlIj4KICAgICAgPHBh%0D%0AdGgKICAgICAgICAgZD0iTSAwLDAgNSwtNSAtMTIuNSwwIDUsNSAwLDAgeiIKICAgICAgICAgdHJh%0D%0AbnNmb3JtPSJtYXRyaXgoMC40LDAsMCwwLjQsNCwwKSIKICAgICAgICAgaWQ9InBhdGg0MTQzIgog%0D%0AICAgICAgICBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdp%0D%0AZHRoOjFwdDttYXJrZXItc3RhcnQ6bm9uZSIgLz4KICAgIDwvbWFya2VyPgogICAgPG1hcmtlcgog%0D%0AICAgICAgcmVmWD0iMCIKICAgICAgIHJlZlk9IjAiCiAgICAgICBvcmllbnQ9ImF1dG8iCiAgICAg%0D%0AICBpZD0iQXJyb3cxTHN0YXJ0IgogICAgICAgc3R5bGU9Im92ZXJmbG93OnZpc2libGUiPgogICAg%0D%0AICA8cGF0aAogICAgICAgICBkPSJNIDAsMCA1LC01IC0xMi41LDAgNSw1IDAsMCB6IgogICAgICAg%0D%0AICB0cmFuc2Zvcm09Im1hdHJpeCgwLjgsMCwwLDAuOCwxMCwwKSIKICAgICAgICAgaWQ9InBhdGg0%0D%0AMTM3IgogICAgICAgICBzdHlsZT0iZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOiMwMDAwMDA7c3Ry%0D%0Ab2tlLXdpZHRoOjFwdDttYXJrZXItc3RhcnQ6bm9uZSIgLz4KICAgIDwvbWFya2VyPgogICAgPG1h%0D%0AcmtlcgogICAgICAgcmVmWD0iMCIKICAgICAgIHJlZlk9IjAiCiAgICAgICBvcmllbnQ9ImF1dG8i%0D%0ACiAgICAgICBpZD0iQXJyb3cyTHN0YXJ0IgogICAgICAgc3R5bGU9Im92ZXJmbG93OnZpc2libGUi%0D%0APgogICAgICA8cGF0aAogICAgICAgICBkPSJNIDguNzE4NTg3OCw0LjAzMzczNTIgLTIuMjA3Mjg5%0D%0ANSwwLjAxNjAxMzI2IDguNzE4NTg4NCwtNC4wMDE3MDc4IGMgLTEuNzQ1NDk4NCwyLjM3MjA2MDkg%0D%0ALTEuNzM1NDQwOCw1LjYxNzQ1MTkgLTZlLTcsOC4wMzU0NDMgeiIKICAgICAgICAgdHJhbnNmb3Jt%0D%0APSJtYXRyaXgoMS4xLDAsMCwxLjEsMS4xLDApIgogICAgICAgICBpZD0icGF0aDQxNTUiCiAgICAg%0D%0AICAgIHN0eWxlPSJmb250LXNpemU6MTJweDtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2Utd2lkdGg6%0D%0AMC42MjU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kIiAvPgogICAgPC9tYXJrZXI+CiAgPC9kZWZzPgog%0D%0AIDxnCiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTYzLjU3MTQzLC00MDkuNTA1MDQpIgogICAg%0D%0AIGlkPSJsYXllcjEiPgogICAgPGcKICAgICAgIGlkPSJnNDM1MiIKICAgICAgIHN0eWxlPSJmaWxs%0D%0AOiM2NjZkNmY7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmUiPgogICAgICA8cGF0aAogICAgICAg%0D%0AICBkPSJtIDgyLjU5Mzc1LDQ5Ni42MjUgMCwxIDEzMiwwIDAsLTEgLTEzMiwwIHoiCiAgICAgICAg%0D%0AIGlkPSJwYXRoMzE2MyIKICAgICAgICAgc3R5bGU9ImZpbGw6IzY2NmQ2ZjtmaWxsLW9wYWNpdHk6%0D%0AMTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZSIgLz4KICAgICAgPHBhdGgKICAgICAgICAg%0D%0AZD0ibSA4Mi41OTgyMTQsNDk3LjEzMDA0IDIsLTIgLTcsMiA3LDIgLTIsLTIgeiIKICAgICAgICAg%0D%0AaWQ9InBhdGg0MzU4IgogICAgICAgICBzdHlsZT0iZmlsbDojNjY2ZDZmO2ZpbGwtb3BhY2l0eTox%0D%0AO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjRwdDttYXJrZXIt%0D%0Ac3RhcnQ6bm9uZSIgLz4KICAgICAgPHBhdGgKICAgICAgICAgZD0ibSAyMTQuNTk4MjEsNDk3LjEz%0D%0AMDA0IC0yLDIgNywtMiAtNywtMiAyLDIgeiIKICAgICAgICAgaWQ9InBhdGg0MzYwIgogICAgICAg%0D%0AICBzdHlsZT0iZmlsbDojNjY2ZDZmO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpldmVub2RkO3N0%0D%0Acm9rZTpub25lO3N0cm9rZS13aWR0aDowLjRwdDttYXJrZXItc3RhcnQ6bm9uZSIgLz4KICAgIDwv%0D%0AZz4KICAgIDxnCiAgICAgICBpZD0iZzQzNDIiCiAgICAgICBzdHlsZT0iZmlsbDojNjY2ZDZmO2Zp%0D%0AbGwtb3BhY2l0eToxO3N0cm9rZTpub25lIj4KICAgICAgPHBhdGgKICAgICAgICAgZD0ibSAxNDgu%0D%0ANzgxMjUsNDI1LjU5Mzc1IDAsMTQyLjM3NSAxLDAgMCwtMTQyLjM3NSAtMSwwIHoiCiAgICAgICAg%0D%0AIGlkPSJwYXRoMzE2MSIKICAgICAgICAgc3R5bGU9ImZpbGw6IzY2NmQ2ZjtmaWxsLW9wYWNpdHk6%0D%0AMTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZSIgLz4KICAgICAgPHBhdGgKICAgICAgICAg%0D%0AZD0ibSAxNDkuMjg1NzEsNDI1LjYwMzI2IDIsMiAtMiwtNyAtMiw3IDIsLTIgeiIKICAgICAgICAg%0D%0AaWQ9InBhdGg0MzQ4IgogICAgICAgICBzdHlsZT0iZmlsbDojNjY2ZDZmO2ZpbGwtb3BhY2l0eTox%0D%0AO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjRwdDttYXJrZXIt%0D%0Ac3RhcnQ6bm9uZSIgLz4KICAgICAgPHBhdGgKICAgICAgICAgZD0ibSAxNDkuMjg1NzEsNTY3Ljk2%0D%0AMDQgLTIsLTIgMiw3IDIsLTcgLTIsMiB6IgogICAgICAgICBpZD0icGF0aDQzNTAiCiAgICAgICAg%0D%0AIHN0eWxlPSJmaWxsOiM2NjZkNmY7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ry%0D%0Ab2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuNHB0O21hcmtlci1zdGFydDpub25lIiAvPgogICAgPC9n%0D%0APgogICAgPHBhdGgKICAgICAgIGQ9Im0gMjExLjM3NDQyLDQyMS45MDA3MyBjIC0zMy43OTAzMiw3%0D%0ANC44MDE5MSAtMzMuOTQ3NDUsNzQuOTE2OCAtMC41MDUwOCwxNDguODcxMjMiCiAgICAgICBpZD0i%0D%0AcGF0aDIxODgiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojZDIwMDAwO3N0cm9rZS13%0D%0AaWR0aDoxLjIwMDAwMDA1O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3Vu%0D%0AZDtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1vcGFjaXR5OjE7c3Ryb2tlLWRhc2hhcnJheTpu%0D%0Ab25lIiAvPgogICAgPGcKICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3My4xODc1LC0wLjEz%0D%0AMzkzMzUpIgogICAgICAgaWQ9Imc0NDA1Ij4KICAgICAgPGcKICAgICAgICAgaWQ9Imc0NDA3Igog%0D%0AICAgICAgICBzdHlsZT0iZmlsbDojNjY2ZDZmO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lIj4K%0D%0AICAgICAgICA8cGF0aAogICAgICAgICAgIGQ9Im0gODIuNTkzNzUsNDk2LjYyNSAwLDEgMTMyLDAg%0D%0AMCwtMSAtMTMyLDAgeiIKICAgICAgICAgICBpZD0icGF0aDQ0MDkiCiAgICAgICAgICAgc3R5bGU9%0D%0AImZpbGw6IzY2NmQ2ZjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9u%0D%0AZSIgLz4KICAgICAgICA8cGF0aAogICAgICAgICAgIGQ9Im0gODIuNTk4MjE0LDQ5Ny4xMzAwNCAy%0D%0ALC0yIC03LDIgNywyIC0yLC0yIHoiCiAgICAgICAgICAgaWQ9InBhdGg0NDExIgogICAgICAgICAg%0D%0AIHN0eWxlPSJmaWxsOiM2NjZkNmY7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ry%0D%0Ab2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuNHB0O21hcmtlci1zdGFydDpub25lIiAvPgogICAgICAg%0D%0AIDxwYXRoCiAgICAgICAgICAgZD0ibSAyMTQuNTk4MjEsNDk3LjEzMDA0IC0yLDIgNywtMiAtNywt%0D%0AMiAyLDIgeiIKICAgICAgICAgICBpZD0icGF0aDQ0MTMiCiAgICAgICAgICAgc3R5bGU9ImZpbGw6%0D%0AIzY2NmQ2ZjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJv%0D%0Aa2Utd2lkdGg6MC40cHQ7bWFya2VyLXN0YXJ0Om5vbmUiIC8+CiAgICAgIDwvZz4KICAgICAgPGcK%0D%0AICAgICAgICAgaWQ9Imc0NDE1Ij4KICAgICAgICA8ZwogICAgICAgICAgIGlkPSJnNDQxNyIKICAg%0D%0AICAgICAgICBzdHlsZT0iZmlsbDojNjY2ZDZmO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lIj4K%0D%0AICAgICAgICAgIDxwYXRoCiAgICAgICAgICAgICBkPSJtIDE0OC43ODEyNSw0MjUuNTkzNzUgMCwx%0D%0ANDIuMzc1IDEsMCAwLC0xNDIuMzc1IC0xLDAgeiIKICAgICAgICAgICAgIGlkPSJwYXRoNDQxOSIK%0D%0AICAgICAgICAgICAgIHN0eWxlPSJmaWxsOiM2NjZkNmY7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxl%0D%0AOmV2ZW5vZGQ7c3Ryb2tlOm5vbmUiIC8+CiAgICAgICAgICA8cGF0aAogICAgICAgICAgICAgZD0i%0D%0AbSAxNDkuMjg1NzEsNDI1LjYwMzI2IDIsMiAtMiwtNyAtMiw3IDIsLTIgeiIKICAgICAgICAgICAg%0D%0AIGlkPSJwYXRoNDQyMSIKICAgICAgICAgICAgIHN0eWxlPSJmaWxsOiM2NjZkNmY7ZmlsbC1vcGFj%0D%0AaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuNHB0O21h%0D%0Acmtlci1zdGFydDpub25lIiAvPgogICAgICAgICAgPHBhdGgKICAgICAgICAgICAgIGQ9Im0gMTQ5%0D%0ALjI4NTcxLDU2Ny45NjA0IC0yLC0yIDIsNyAyLC03IC0yLDIgeiIKICAgICAgICAgICAgIGlkPSJw%0D%0AYXRoNDQyMyIKICAgICAgICAgICAgIHN0eWxlPSJmaWxsOiM2NjZkNmY7ZmlsbC1vcGFjaXR5OjE7%0D%0AZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuNHB0O21hcmtlci1z%0D%0AdGFydDpub25lIiAvPgogICAgICAgIDwvZz4KICAgICAgICA8cGF0aAogICAgICAgICAgIGQ9Im0g%0D%0AMjExLjM3NDQyLDQyMS45MDA3MyBjIC0yLjAyMDMxLDYuMzEzNDUgLTI2LjI4ODM0LDQ3LjE4NTg3%0D%0AIC00MC43ODQ5MSw0Ni4zNDA3NCAtMTMuMTcwMTgsLTAuNzY3NzkgLTI3LjI3NDEyLC0xNS4yNzg1%0D%0ANiAtNDMuOTQxNjMsLTE1LjI3ODU2IC0xNi42Njc1MiwwIC0yNy41MjY2NjEsMTguNDM1MjggLTI3%0D%0ALjQwMDM5Miw0NC41NzI5OSAwLjEyMzIyNCwyNS41MDczIDEzLjA2MTcxMiw0NC40OTI1IDI3LjI3%0D%0ANDEyMiw0My45NDE2MyAxNi4yODg3LC0wLjYzMTM1IDI5LjczNTk1LC0xMy40MDAzNyA0NC4xOTQx%0D%0ANywtMTQuODk5NzUgMTcuMDQ2MzIsLTEuNzY3NzcgMzkuMTQzNDEsNDEuNjY4NzkgNDAuMTUzNTYs%0D%0ANDQuMTk0MTgiCiAgICAgICAgICAgaWQ9InBhdGg0NDI1IgogICAgICAgICAgIHN0eWxlPSJmaWxs%0D%0AOm5vbmU7c3Ryb2tlOiNkMjAwMDA7c3Ryb2tlLXdpZHRoOjEuMjAwMDAwMDU7c3Ryb2tlLWxpbmVj%0D%0AYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tl%0D%0ALW9wYWNpdHk6MTtzdHJva2UtZGFzaGFycmF5Om5vbmUiIC8+CiAgICAgIDwvZz4KICAgIDwvZz4K%0D%0AICAgIDx0ZXh0CiAgICAgICB4PSI3My41NzE0MzQiCiAgICAgICB5PSI0MjkuMzM4NzUiCiAgICAg%0D%0AICBpZD0idGV4dDU1MTIiCiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9%0D%0AImZvbnQtc2l6ZToxNnB4O2ZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmaWxs%0D%0AOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7Zm9udC1mYW1pbHk6QXJpYWwiPjx0%0D%0Ac3BhbgogICAgICAgICB4PSI3My41NzE0MzQiCiAgICAgICAgIHk9IjQyOS4zMzg3NSIKICAgICAg%0D%0AICAgaWQ9InRzcGFuNTUxNCI+MTwvdHNwYW4+PC90ZXh0PgogICAgPHRleHQKICAgICAgIHg9IjI1%0D%0AMS4xNTMyNiIKICAgICAgIHk9IjQyOS4zMzg3NSIKICAgICAgIGlkPSJ0ZXh0NTUxNiIKICAgICAg%0D%0AIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC1zaXplOjE2cHg7Zm9udC1z%0D%0AdHlsZTpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6%0D%0AMTtzdHJva2U6bm9uZTtmb250LWZhbWlseTpBcmlhbCI+PHRzcGFuCiAgICAgICAgIHg9IjI1MS4x%0D%0ANTMyNiIKICAgICAgICAgeT0iNDI5LjMzODc1IgogICAgICAgICBpZD0idHNwYW41NTE4Ij4yPC90%0D%0Ac3Bhbj48L3RleHQ+CiAgICA8cGF0aAogICAgICAgZD0ibSAxNDkuMzMyODcsNDk3LjI4NDAyIGMg%0D%0AMCw4LjAxNTU2IC0yLjY1ODcyLDE1LjI3NjAzIC02Ljk1NTQxLDIwLjUzMjYyIC00LjI5NjY4LDUu%0D%0AMjU2NTggLTkuMjIxMTgsOS4wMTQzNSAtMTUuNzczMDMsOS4wMTQzNSAtMTMuMTAzNjksMCAtMTgu%0D%0ANjg3ODIsLTEzLjAxMDc3IC0xOC42ODc4MiwtMjkuMDQxODkgMCwtMTYuMDMxMTIgNS41ODQxMywt%0D%0AMjkuMDQxODggMTguNjg3ODIsLTI5LjA0MTg4IDYuNTUxODUsMCAxMS40NzYzNSwyLjc0NzYxIDE1%0D%0ALjc3MzAzLDguMDA0MTkgNC4yOTY2OSw1LjI1NjU4IDYuOTU1NDEsMTIuNTE3MDUgNi45NTU0MSwy%0D%0AMC41MzI2MSB6IgogICAgICAgaWQ9InBhdGgyMjc1IgogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtz%0D%0AdHJva2U6I2QyMDAwMDtzdHJva2Utd2lkdGg6MS4yMDAwMDAwNTtzdHJva2UtbGluZWNhcDpyb3Vu%0D%0AZDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2Utb3BhY2l0%0D%0AeToxO3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowIiAvPgogICAgPHRl%0D%0AeHQKICAgICAgIHg9IjExMS40NTI3OSIKICAgICAgIHk9IjU4OS41ODk3OCIKICAgICAgIGlkPSJ0%0D%0AZXh0MzAyNiIKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC1z%0D%0AaXplOjE2cHg7Zm9udC1zdHlsZTppdGFsaWM7Zm9udC13ZWlnaHQ6bm9ybWFsO2xpbmUtaGVpZ2h0%0D%0AOjEyNSU7bGV0dGVyLXNwYWNpbmc6MHB4O3dvcmQtc3BhY2luZzowcHg7ZmlsbDojMDAwMDAwO2Zp%0D%0AbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO2ZvbnQtZmFtaWx5OlNhbnM7LWlua3NjYXBlLWZvbnQt%0D%0Ac3BlY2lmaWNhdGlvbjpTYW5zIEl0YWxpYyI+PHRzcGFuCiAgICAgICAgIHg9IjExMS40NTI3OSIK%0D%0AICAgICAgICAgeT0iNTg5LjU4OTc4IgogICAgICAgICBpZD0idHNwYW4zMDI4Ij55wrIgPSB4wrMg%0D%0A4oCTIHg8L3RzcGFuPjwvdGV4dD4KICAgIDx0ZXh0CiAgICAgICB4PSIyNjUuMjY2MzMiCiAgICAg%0D%0AICB5PSI1ODkuNTg5NzgiCiAgICAgICBpZD0idGV4dDMwMzAiCiAgICAgICB4bWw6c3BhY2U9InBy%0D%0AZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtc2l6ZToxNnB4O2ZvbnQtc3R5bGU6aXRhbGljO2Zv%0D%0AbnQtd2VpZ2h0Om5vcm1hbDtsaW5lLWhlaWdodDoxMjUlO2xldHRlci1zcGFjaW5nOjBweDt3b3Jk%0D%0ALXNwYWNpbmc6MHB4O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtmb250%0D%0ALWZhbWlseTpTYW5zOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246U2FucyBJdGFsaWMiPjx0%0D%0Ac3BhbgogICAgICAgICB4PSIyNjUuMjY2MzMiCiAgICAgICAgIHk9IjU4OS41ODk3OCIKICAgICAg%0D%0AICAgaWQ9InRzcGFuMzAzMiI+ecKyID0geMKzIOKAkyB4ICsgMTwvdHNwYW4+PC90ZXh0PgogIDwv%0D%0AZz4KPC9zdmc+Cg==)

&emsp;&emsp;椭圆曲线的定义也要求曲线是非奇异的(即处处可导的)。几何上来说，这意味着图像里面没有尖点、自相交或孤立点。代数上来说，这成立当且仅当判别式:

![disc](data:image/svg+xml;base64,PHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjIx%0D%0ALjY0ZXgiIGhlaWdodD0iMy4xNzZleCIgc3R5bGU9InZlcnRpY2FsLWFsaWduOiAtMC44MzhleDsi%0D%0AIHZpZXdCb3g9IjAgLTEwMDYuNiA5MzE3LjMgMTM2Ny40IiByb2xlPSJpbWciIGZvY3VzYWJsZT0i%0D%0AZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgYXJpYS1sYWJlbGxlZGJ5%0D%0APSJNYXRoSmF4LVNWRy0xLVRpdGxlIj4KPHRpdGxlIGlkPSJNYXRoSmF4LVNWRy0xLVRpdGxlIj57%0D%0AXGRpc3BsYXlzdHlsZSBcRGVsdGEgPS0xNig0YV57M30rMjdiXnsyfSl9PC90aXRsZT4KPGRlZnMg%0D%0AYXJpYS1oaWRkZW49InRydWUiPgo8cGF0aCBzdHJva2Utd2lkdGg9IjEiIGlkPSJFMS1NSk1BSU4t%0D%0AMzk0IiBkPSJNNTEgMFE0NiA0IDQ2IDdRNDYgOSAyMTUgMzU3VDM4OCA3MDlRMzkxIDcxNiA0MTYg%0D%0ANzE2UTQzOSA3MTYgNDQ0IDcwOVE0NDcgNzA1IDYxNiAzNTdUNzg2IDdRNzg2IDQgNzgxIDBINTFa%0D%0ATTUwNyAzNDRMMzg0IDU5NkwxMzcgOTJMMzgzIDkxSDYzMFE2MzAgOTMgNTA3IDM0NFoiPjwvcGF0%0D%0AaD4KPHBhdGggc3Ryb2tlLXdpZHRoPSIxIiBpZD0iRTEtTUpNQUlOLTNEIiBkPSJNNTYgMzQ3UTU2%0D%0AIDM2MCA3MCAzNjdINzA3UTcyMiAzNTkgNzIyIDM0N1E3MjIgMzM2IDcwOCAzMjhMMzkwIDMyN0g3%0D%0AMlE1NiAzMzIgNTYgMzQ3Wk01NiAxNTNRNTYgMTY4IDcyIDE3M0g3MDhRNzIyIDE2MyA3MjIgMTUz%0D%0AUTcyMiAxNDAgNzA3IDEzM0g3MFE1NiAxNDAgNTYgMTUzWiI+PC9wYXRoPgo8cGF0aCBzdHJva2Ut%0D%0Ad2lkdGg9IjEiIGlkPSJFMS1NSk1BSU4tMjIxMiIgZD0iTTg0IDIzN1Q4NCAyNTBUOTggMjcwSDY3%0D%0AOVE2OTQgMjYyIDY5NCAyNTBUNjc5IDIzMEg5OFE4NCAyMzcgODQgMjUwWiI+PC9wYXRoPgo8cGF0%0D%0AaCBzdHJva2Utd2lkdGg9IjEiIGlkPSJFMS1NSk1BSU4tMzEiIGQ9Ik0yMTMgNTc4TDIwMCA1NzNR%0D%0AMTg2IDU2OCAxNjAgNTYzVDEwMiA1NTZIODNWNjAySDEwMlExNDkgNjA0IDE4OSA2MTdUMjQ1IDY0%0D%0AMVQyNzMgNjYzUTI3NSA2NjYgMjg1IDY2NlEyOTQgNjY2IDMwMiA2NjBWMzYxTDMwMyA2MVEzMTAg%0D%0ANTQgMzE1IDUyVDMzOSA0OFQ0MDEgNDZINDI3VjBINDE2UTM5NSAzIDI1NyAzUTEyMSAzIDEwMCAw%0D%0ASDg4VjQ2SDExNFExMzYgNDYgMTUyIDQ2VDE3NyA0N1QxOTMgNTBUMjAxIDUyVDIwNyA1N1QyMTMg%0D%0ANjFWNTc4WiI+PC9wYXRoPgo8cGF0aCBzdHJva2Utd2lkdGg9IjEiIGlkPSJFMS1NSk1BSU4tMzYi%0D%0AIGQ9Ik00MiAzMTNRNDIgNDc2IDEyMyA1NzFUMzAzIDY2NlEzNzIgNjY2IDQwMiA2MzBUNDMyIDU1%0D%0AMFE0MzIgNTI1IDQxOCA1MTBUMzc5IDQ5NVEzNTYgNDk1IDM0MSA1MDlUMzI2IDU0OFEzMjYgNTky%0D%0AIDM3MyA2MDFRMzUxIDYyMyAzMTEgNjI2UTI0MCA2MjYgMTk0IDU2NlExNDcgNTAwIDE0NyAzNjRM%0D%0AMTQ4IDM2MFExNTMgMzY2IDE1NiAzNzNRMTk3IDQzMyAyNjMgNDMzSDI2N1EzMTMgNDMzIDM0OCA0%0D%0AMTRRMzcyIDQwMCAzOTYgMzc0VDQzNSAzMTdRNDU2IDI2OCA0NTYgMjEwVjE5MlE0NTYgMTY5IDQ1%0D%0AMSAxNDlRNDQwIDkwIDM4NyAzNFQyNTMgLTIyUTIyNSAtMjIgMTk5IC0xNFQxNDMgMTZUOTIgNzVU%0D%0ANTYgMTcyVDQyIDMxM1pNMjU3IDM5N1EyMjcgMzk3IDIwNSAzODBUMTcxIDMzNVQxNTQgMjc4VDE0%0D%0AOCAyMTZRMTQ4IDEzMyAxNjAgOTdUMTk4IDM5UTIyMiAyMSAyNTEgMjFRMzAyIDIxIDMyOSA1OVEz%0D%0ANDIgNzcgMzQ3IDEwNFQzNTIgMjA5UTM1MiAyODkgMzQ3IDMxNlQzMjkgMzYxUTMwMiAzOTcgMjU3%0D%0AIDM5N1oiPjwvcGF0aD4KPHBhdGggc3Ryb2tlLXdpZHRoPSIxIiBpZD0iRTEtTUpNQUlOLTI4IiBk%0D%0APSJNOTQgMjUwUTk0IDMxOSAxMDQgMzgxVDEyNyA0ODhUMTY0IDU3NlQyMDIgNjQzVDI0NCA2OTVU%0D%0AMjc3IDcyOVQzMDIgNzUwSDMxNUgzMTlRMzMzIDc1MCAzMzMgNzQxUTMzMyA3MzggMzE2IDcyMFQy%0D%0ANzUgNjY3VDIyNiA1ODFUMTg0IDQ0M1QxNjcgMjUwVDE4NCA1OFQyMjUgLTgxVDI3NCAtMTY3VDMx%0D%0ANiAtMjIwVDMzMyAtMjQxUTMzMyAtMjUwIDMxOCAtMjUwSDMxNUgzMDJMMjc0IC0yMjZRMTgwIC0x%0D%0ANDEgMTM3IC0xNFQ5NCAyNTBaIj48L3BhdGg+CjxwYXRoIHN0cm9rZS13aWR0aD0iMSIgaWQ9IkUx%0D%0ALU1KTUFJTi0zNCIgZD0iTTQ2MiAwUTQ0NCAzIDMzMyAzUTIxNyAzIDE5OSAwSDE5MFY0NkgyMjFR%0D%0AMjQxIDQ2IDI0OCA0NlQyNjUgNDhUMjc5IDUzVDI4NiA2MVEyODcgNjMgMjg3IDExNVYxNjVIMjhW%0D%0AMjExTDE3OSA0NDJRMzMyIDY3NCAzMzQgNjc1UTMzNiA2NzcgMzU1IDY3N0gzNzNMMzc5IDY3MVYy%0D%0AMTFINDcxVjE2NUgzNzlWMTE0UTM3OSA3MyAzNzkgNjZUMzg1IDU0UTM5MyA0NyA0NDIgNDZINDcx%0D%0AVjBINDYyWk0yOTMgMjExVjU0NUw3NCAyMTJMMTgzIDIxMUgyOTNaIj48L3BhdGg+CjxwYXRoIHN0%0D%0Acm9rZS13aWR0aD0iMSIgaWQ9IkUxLU1KTUFUSEktNjEiIGQ9Ik0zMyAxNTdRMzMgMjU4IDEwOSAz%0D%0ANDlUMjgwIDQ0MVEzMzEgNDQxIDM3MCAzOTJRMzg2IDQyMiA0MTYgNDIyUTQyOSA0MjIgNDM5IDQx%0D%0ANFQ0NDkgMzk0UTQ0OSAzODEgNDEyIDIzNFQzNzQgNjhRMzc0IDQzIDM4MSAzNVQ0MDIgMjZRNDEx%0D%0AIDI3IDQyMiAzNVE0NDMgNTUgNDYzIDEzMVE0NjkgMTUxIDQ3MyAxNTJRNDc1IDE1MyA0ODMgMTUz%0D%0ASDQ4N1E1MDYgMTUzIDUwNiAxNDRRNTA2IDEzOCA1MDEgMTE3VDQ4MSA2M1Q0NDkgMTNRNDM2IDAg%0D%0ANDE3IC04UTQwOSAtMTAgMzkzIC0xMFEzNTkgLTEwIDMzNiA1VDMwNiAzNkwzMDAgNTFRMjk5IDUy%0D%0AIDI5NiA1MFEyOTQgNDggMjkyIDQ2UTIzMyAtMTAgMTcyIC0xMFExMTcgLTEwIDc1IDMwVDMzIDE1%0D%0AN1pNMzUxIDMyOFEzNTEgMzM0IDM0NiAzNTBUMzIzIDM4NVQyNzcgNDA1UTI0MiA0MDUgMjEwIDM3%0D%0ANFQxNjAgMjkzUTEzMSAyMTQgMTE5IDEyOVExMTkgMTI2IDExOSAxMThUMTE4IDEwNlExMTggNjEg%0D%0AMTM2IDQ0VDE3OSAyNlEyMTcgMjYgMjU0IDU5VDI5OCAxMTBRMzAwIDExNCAzMjUgMjE3VDM1MSAz%0D%0AMjhaIj48L3BhdGg+CjxwYXRoIHN0cm9rZS13aWR0aD0iMSIgaWQ9IkUxLU1KTUFJTi0zMyIgZD0i%0D%0ATTEyNyA0NjNRMTAwIDQ2MyA4NSA0ODBUNjkgNTI0UTY5IDU3OSAxMTcgNjIyVDIzMyA2NjVRMjY4%0D%0AIDY2NSAyNzcgNjY0UTM1MSA2NTIgMzkwIDYxMVQ0MzAgNTIyUTQzMCA0NzAgMzk2IDQyMVQzMDIg%0D%0AMzUwTDI5OSAzNDhRMjk5IDM0NyAzMDggMzQ1VDMzNyAzMzZUMzc1IDMxNVE0NTcgMjYyIDQ1NyAx%0D%0ANzVRNDU3IDk2IDM5NSAzN1QyMzggLTIyUTE1OCAtMjIgMTAwIDIxVDQyIDEzMFE0MiAxNTggNjAg%0D%0AMTc1VDEwNSAxOTNRMTMzIDE5MyAxNTEgMTc1VDE2OSAxMzBRMTY5IDExOSAxNjYgMTEwVDE1OSA5%0D%0ANFQxNDggODJUMTM2IDc0VDEyNiA3MFQxMTggNjdMMTE0IDY2UTE2NSAyMSAyMzggMjFRMjkzIDIx%0D%0AIDMyMSA3NFEzMzggMTA3IDMzOCAxNzVWMTk1UTMzOCAyOTAgMjc0IDMyMlEyNTkgMzI4IDIxMyAz%0D%0AMjlMMTcxIDMzMEwxNjggMzMyUTE2NiAzMzUgMTY2IDM0OFExNjYgMzY2IDE3NCAzNjZRMjAyIDM2%0D%0ANiAyMzIgMzcxUTI2NiAzNzYgMjk0IDQxM1QzMjIgNTI1VjUzM1EzMjIgNTkwIDI4NyA2MTJRMjY1%0D%0AIDYyNiAyNDAgNjI2UTIwOCA2MjYgMTgxIDYxNVQxNDMgNTkyVDEzMiA1ODBIMTM1UTEzOCA1Nzkg%0D%0AMTQzIDU3OFQxNTMgNTczVDE2NSA1NjZUMTc1IDU1NVQxODMgNTQwVDE4NiA1MjBRMTg2IDQ5OCAx%0D%0ANzIgNDgxVDEyNyA0NjNaIj48L3BhdGg+CjxwYXRoIHN0cm9rZS13aWR0aD0iMSIgaWQ9IkUxLU1K%0D%0ATUFJTi0yQiIgZD0iTTU2IDIzN1Q1NiAyNTBUNzAgMjcwSDM2OVY0MjBMMzcwIDU3MFEzODAgNTgz%0D%0AIDM4OSA1ODNRNDAyIDU4MyA0MDkgNTY4VjI3MEg3MDdRNzIyIDI2MiA3MjIgMjUwVDcwNyAyMzBI%0D%0ANDA5Vi02OFE0MDEgLTgyIDM5MSAtODJIMzg5SDM4N1EzNzUgLTgyIDM2OSAtNjhWMjMwSDcwUTU2%0D%0AIDIzNyA1NiAyNTBaIj48L3BhdGg+CjxwYXRoIHN0cm9rZS13aWR0aD0iMSIgaWQ9IkUxLU1KTUFJ%0D%0ATi0zMiIgZD0iTTEwOSA0MjlRODIgNDI5IDY2IDQ0N1Q1MCA0OTFRNTAgNTYyIDEwMyA2MTRUMjM1%0D%0AIDY2NlEzMjYgNjY2IDM4NyA2MTBUNDQ5IDQ2NVE0NDkgNDIyIDQyOSAzODNUMzgxIDMxNVQzMDEg%0D%0AMjQxUTI2NSAyMTAgMjAxIDE0OUwxNDIgOTNMMjE4IDkyUTM3NSA5MiAzODUgOTdRMzkyIDk5IDQw%0D%0AOSAxODZWMTg5SDQ0OVYxODZRNDQ4IDE4MyA0MzYgOTVUNDIxIDNWMEg1MFYxOVYzMVE1MCAzOCA1%0D%0ANiA0NlQ4NiA4MVExMTUgMTEzIDEzNiAxMzdRMTQ1IDE0NyAxNzAgMTc0VDIwNCAyMTFUMjMzIDI0%0D%0ANFQyNjEgMjc4VDI4NCAzMDhUMzA1IDM0MFQzMjAgMzY5VDMzMyA0MDFUMzQwIDQzMVQzNDMgNDY0%0D%0AUTM0MyA1MjcgMzA5IDU3M1QyMTIgNjE5UTE3OSA2MTkgMTU0IDYwMlQxMTkgNTY5VDEwOSA1NTBR%0D%0AMTA5IDU0OSAxMTQgNTQ5UTEzMiA1NDkgMTUxIDUzNVQxNzAgNDg5UTE3MCA0NjQgMTU0IDQ0N1Qx%0D%0AMDkgNDI5WiI+PC9wYXRoPgo8cGF0aCBzdHJva2Utd2lkdGg9IjEiIGlkPSJFMS1NSk1BSU4tMzci%0D%0AIGQ9Ik01NSA0NThRNTYgNDYwIDcyIDU2N0w4OCA2NzRRODggNjc2IDEwOCA2NzZIMTI4VjY3MlEx%0D%0AMjggNjYyIDE0MyA2NTVUMTk1IDY0NlQzNjQgNjQ0SDQ4NVY2MDVMNDE3IDUxMlE0MDggNTAwIDM4%0D%0ANyA0NzJUMzYwIDQzNVQzMzkgNDAzVDMxOSAzNjdUMzA1IDMzMFQyOTIgMjg0VDI4NCAyMzBUMjc4%0D%0AIDE2MlQyNzUgODBRMjc1IDY2IDI3NSA1MlQyNzQgMjhWMTlRMjcwIDIgMjU1IC0xMFQyMjEgLTIy%0D%0AUTIxMCAtMjIgMjAwIC0xOVQxNzkgMFQxNjggNDBRMTY4IDE5OCAyNjUgMzY4UTI4NSA0MDAgMzQ5%0D%0AIDQ4OUwzOTUgNTUySDMwMlExMjggNTUyIDExOSA1NDZRMTEzIDU0MyAxMDggNTIyVDk4IDQ3OUw5%0D%0ANSA0NThWNDU1SDU1VjQ1OFoiPjwvcGF0aD4KPHBhdGggc3Ryb2tlLXdpZHRoPSIxIiBpZD0iRTEt%0D%0ATUpNQVRISS02MiIgZD0iTTczIDY0N1E3MyA2NTcgNzcgNjcwVDg5IDY4M1E5MCA2ODMgMTYxIDY4%0D%0AOFQyMzQgNjk0UTI0NiA2OTQgMjQ2IDY4NVQyMTIgNTQyUTIwNCA1MDggMTk1IDQ3MlQxODAgNDE4%0D%0ATDE3NiAzOTlRMTc2IDM5NiAxODIgNDAyUTIzMSA0NDIgMjgzIDQ0MlEzNDUgNDQyIDM4MyAzOTZU%0D%0ANDIyIDI4MFE0MjIgMTY5IDM0MyA3OVQxNzMgLTExUTEyMyAtMTEgODIgMjdUNDAgMTUwVjE1OVE0%0D%0AMCAxODAgNDggMjE3VDk3IDQxNFExNDcgNjExIDE0NyA2MjNUMTA5IDYzN1ExMDQgNjM3IDEwMSA2%0D%0AMzdIOTZRODYgNjM3IDgzIDYzN1Q3NiA2NDBUNzMgNjQ3Wk0zMzYgMzI1VjMzMVEzMzYgNDA1IDI3%0D%0ANSA0MDVRMjU4IDQwNSAyNDAgMzk3VDIwNyAzNzZUMTgxIDM1MlQxNjMgMzMwTDE1NyAzMjJMMTM2%0D%0AIDIzNlExMTQgMTUwIDExNCAxMTRRMTE0IDY2IDEzOCA0MlExNTQgMjYgMTc4IDI2UTIxMSAyNiAy%0D%0ANDUgNThRMjcwIDgxIDI4NSAxMTRUMzE4IDIxOVEzMzYgMjkxIDMzNiAzMjVaIj48L3BhdGg+Cjxw%0D%0AYXRoIHN0cm9rZS13aWR0aD0iMSIgaWQ9IkUxLU1KTUFJTi0yOSIgZD0iTTYwIDc0OUw2NCA3NTBR%0D%0ANjkgNzUwIDc0IDc1MEg4NkwxMTQgNzI2UTIwOCA2NDEgMjUxIDUxNFQyOTQgMjUwUTI5NCAxODIg%0D%0AMjg0IDExOVQyNjEgMTJUMjI0IC03NlQxODYgLTE0M1QxNDUgLTE5NFQxMTMgLTIyN1Q5MCAtMjQ2%0D%0AUTg3IC0yNDkgODYgLTI1MEg3NFE2NiAtMjUwIDYzIC0yNTBUNTggLTI0N1Q1NSAtMjM4UTU2IC0y%0D%0AMzcgNjYgLTIyNVEyMjEgLTY0IDIyMSAyNTBUNjYgNzI1UTU2IDczNyA1NSA3MzhRNTUgNzQ2IDYw%0D%0AIDc0OVoiPjwvcGF0aD4KPC9kZWZzPgo8ZyBzdHJva2U9ImN1cnJlbnRDb2xvciIgZmlsbD0iY3Vy%0D%0AcmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjAiIHRyYW5zZm9ybT0ibWF0cml4KDEgMCAwIC0xIDAg%0D%0AMCkiIGFyaWEtaGlkZGVuPSJ0cnVlIj4KIDx1c2UgeGxpbms6aHJlZj0iI0UxLU1KTUFJTi0zOTQi%0D%0AIHg9IjAiIHk9IjAiPjwvdXNlPgogPHVzZSB4bGluazpocmVmPSIjRTEtTUpNQUlOLTNEIiB4PSIx%0D%0AMTExIiB5PSIwIj48L3VzZT4KIDx1c2UgeGxpbms6aHJlZj0iI0UxLU1KTUFJTi0yMjEyIiB4PSIy%0D%0AMTY3IiB5PSIwIj48L3VzZT4KPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjk0NiwwKSI+CiA8dXNl%0D%0AIHhsaW5rOmhyZWY9IiNFMS1NSk1BSU4tMzEiPjwvdXNlPgogPHVzZSB4bGluazpocmVmPSIjRTEt%0D%0ATUpNQUlOLTM2IiB4PSI1MDAiIHk9IjAiPjwvdXNlPgo8L2c+CiA8dXNlIHhsaW5rOmhyZWY9IiNF%0D%0AMS1NSk1BSU4tMjgiIHg9IjM5NDciIHk9IjAiPjwvdXNlPgogPHVzZSB4bGluazpocmVmPSIjRTEt%0D%0ATUpNQUlOLTM0IiB4PSI0MzM2IiB5PSIwIj48L3VzZT4KPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUo%0D%0ANDgzNywwKSI+CiA8dXNlIHhsaW5rOmhyZWY9IiNFMS1NSk1BVEhJLTYxIiB4PSIwIiB5PSIwIj48%0D%0AL3VzZT4KIDx1c2UgdHJhbnNmb3JtPSJzY2FsZSgwLjcwNykiIHhsaW5rOmhyZWY9IiNFMS1NSk1B%0D%0ASU4tMzMiIHg9Ijc0OCIgeT0iNTgzIj48L3VzZT4KPC9nPgogPHVzZSB4bGluazpocmVmPSIjRTEt%0D%0ATUpNQUlOLTJCIiB4PSI2MDQyIiB5PSIwIj48L3VzZT4KPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUo%0D%0ANzA0MywwKSI+CiA8dXNlIHhsaW5rOmhyZWY9IiNFMS1NSk1BSU4tMzIiPjwvdXNlPgogPHVzZSB4%0D%0AbGluazpocmVmPSIjRTEtTUpNQUlOLTM3IiB4PSI1MDAiIHk9IjAiPjwvdXNlPgo8L2c+CjxnIHRy%0D%0AYW5zZm9ybT0idHJhbnNsYXRlKDgwNDQsMCkiPgogPHVzZSB4bGluazpocmVmPSIjRTEtTUpNQVRI%0D%0ASS02MiIgeD0iMCIgeT0iMCI+PC91c2U+CiA8dXNlIHRyYW5zZm9ybT0ic2NhbGUoMC43MDcpIiB4%0D%0AbGluazpocmVmPSIjRTEtTUpNQUlOLTMyIiB4PSI2MDciIHk9IjU4MyI+PC91c2U+CjwvZz4KIDx1%0D%0Ac2UgeGxpbms6aHJlZj0iI0UxLU1KTUFJTi0yOSIgeD0iODkyNyIgeT0iMCI+PC91c2U+CjwvZz4K%0D%0APC9zdmc+)
不为0.

#### 近世代数

---

##### 群

&emsp;&emsp;群（group）是由一种集合以及一个二元运算所组成的，并且符合“群公理”。群公理包含下述四个性质的代数结构。这四个性质是：

1. 封闭性：对于所有G中a, b，运算a·b的结果也在G中。
2. 结合律：对于所有G中的a, b和c，等式 `(a·b)·c = a· (b·c)`成立。
3. 单位元：存在G中的一个元素e，使得对于所有G中的元素a，总有等式`e·a = a·e = a`成立。
4. 对于集合中所有元素存在逆元素



**特殊的群**：


&emsp;&emsp;满足交换律的群称为**交换群**（阿贝尔群），不满足交换律的群称为非交换群（非阿贝尔群）。

&emsp;&emsp;设 (G, · )为一个群，若存在一G内的元素g，使得![group_loog](data:image/svg+xml;base64,PHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjIz%0D%0ALjkyMmV4IiBoZWlnaHQ9IjMuMzQzZXgiIHN0eWxlPSJ2ZXJ0aWNhbC1hbGlnbjogLTEuMDA1ZXg7%0D%0AIiB2aWV3Qm94PSIwIC0xMDA2LjYgMTAyOTkuNyAxNDM5LjIiIHJvbGU9ImltZyIgZm9jdXNhYmxl%0D%0APSJmYWxzZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBhcmlhLWxhYmVsbGVk%0D%0AYnk9Ik1hdGhKYXgtU1ZHLTEtVGl0bGUiPgo8dGl0bGUgaWQ9Ik1hdGhKYXgtU1ZHLTEtVGl0bGUi%0D%0APntcZGlzcGxheXN0eWxlIEc9XGxlZnRcbGFuZ2xlIFwsZ1wsXHJpZ2h0XHJhbmdsZSA9XGxlZnRc%0D%0Ae2dee2t9O1w7a1xpbiBcbWF0aGJiIHtafSBccmlnaHRcfX08L3RpdGxlPgo8ZGVmcyBhcmlhLWhp%0D%0AZGRlbj0idHJ1ZSI+CjxwYXRoIHN0cm9rZS13aWR0aD0iMSIgaWQ9IkUxLU1KTUFUSEktNDciIGQ9%0D%0AIk01MCAyNTJRNTAgMzY3IDExNyA0NzNUMjg2IDY0MVQ0OTAgNzA0UTU4MCA3MDQgNjMzIDY1M1E2%0D%0ANDIgNjQzIDY0OCA2MzZUNjU2IDYyNkw2NTcgNjIzUTY2MCA2MjMgNjg0IDY0OVE2OTEgNjU1IDY5%0D%0AOSA2NjNUNzE1IDY3OVQ3MjUgNjkwTDc0MCA3MDVINzQ2UTc2MCA3MDUgNzYwIDY5OFE3NjAgNjk0%0D%0AIDcyOCA1NjFRNjkyIDQyMiA2OTIgNDIxUTY5MCA0MTYgNjg3IDQxNVQ2NjkgNDEzSDY1M1E2NDcg%0D%0ANDE5IDY0NyA0MjJRNjQ3IDQyMyA2NDggNDI5VDY1MCA0NDlUNjUxIDQ4MVE2NTEgNTUyIDYxOSA2%0D%0AMDVUNTEwIDY1OVE0OTIgNjU5IDQ3MSA2NTZUNDE4IDY0M1QzNTcgNjE1VDI5NCA1NjdUMjM2IDQ5%0D%0ANlQxODkgMzk0VDE1OCAyNjBRMTU2IDI0MiAxNTYgMjIxUTE1NiAxNzMgMTcwIDEzNlQyMDYgNzlU%0D%0AMjU2IDQ1VDMwOCAyOFQzNTMgMjRRNDA3IDI0IDQ1MiA0N1Q1MTQgMTA2UTUxNyAxMTQgNTI5IDE2%0D%0AMVQ1NDEgMjE0UTU0MSAyMjIgNTI4IDIyNFQ0NjggMjI3SDQzMVE0MjUgMjMzIDQyNSAyMzVUNDI3%0D%0AIDI1NFE0MzEgMjY3IDQzNyAyNzNINDU0UTQ5NCAyNzEgNTk0IDI3MVE2MzQgMjcxIDY1OSAyNzFU%0D%0ANjk1IDI3MlQ3MDcgMjcyUTcyMSAyNzIgNzIxIDI2M1E3MjEgMjYxIDcxOSAyNDlRNzE0IDIzMCA3%0D%0AMDkgMjI4UTcwNiAyMjcgNjk0IDIyN1E2NzQgMjI3IDY1MyAyMjRRNjQ2IDIyMSA2NDMgMjE1VDYy%0D%0AOSAxNjRRNjIwIDEzMSA2MTQgMTA4UTU4OSA2IDU4NiAzUTU4NCAxIDU4MSAxUTU3MSAxIDU1MyAy%0D%0AMVQ1MzAgNTJRNTMwIDUzIDUyOCA1MlQ1MjIgNDdRNDQ4IC0yMiAzMjIgLTIyUTIwMSAtMjIgMTI2%0D%0AIDU1VDUwIDI1MloiPjwvcGF0aD4KPHBhdGggc3Ryb2tlLXdpZHRoPSIxIiBpZD0iRTEtTUpNQUlO%0D%0ALTNEIiBkPSJNNTYgMzQ3UTU2IDM2MCA3MCAzNjdINzA3UTcyMiAzNTkgNzIyIDM0N1E3MjIgMzM2%0D%0AIDcwOCAzMjhMMzkwIDMyN0g3MlE1NiAzMzIgNTYgMzQ3Wk01NiAxNTNRNTYgMTY4IDcyIDE3M0g3%0D%0AMDhRNzIyIDE2MyA3MjIgMTUzUTcyMiAxNDAgNzA3IDEzM0g3MFE1NiAxNDAgNTYgMTUzWiI+PC9w%0D%0AYXRoPgo8cGF0aCBzdHJva2Utd2lkdGg9IjEiIGlkPSJFMS1NSk1BSU4tMjdFOCIgZD0iTTMzMyAt%0D%0AMjMyUTMzMiAtMjM5IDMyNyAtMjQ0VDMxMyAtMjUwUTMwMyAtMjUwIDI5NiAtMjQwUTI5MyAtMjMz%0D%0AIDIwMiA2VDExMCAyNTBUMjAxIDQ5NFQyOTYgNzQwUTI5OSA3NDUgMzA2IDc0OUwzMDkgNzUwUTMx%0D%0AMiA3NTAgMzEzIDc1MFEzMzEgNzUwIDMzMyA3MzJRMzMzIDcyNyAyNDMgNDg5UTE1MiAyNTIgMTUy%0D%0AIDI1MFQyNDMgMTFRMzMzIC0yMjcgMzMzIC0yMzJaIj48L3BhdGg+CjxwYXRoIHN0cm9rZS13aWR0%0D%0AaD0iMSIgaWQ9IkUxLU1KTUFUSEktNjciIGQ9Ik0zMTEgNDNRMjk2IDMwIDI2NyAxNVQyMDYgMFEx%0D%0ANDMgMCAxMDUgNDVUNjYgMTYwUTY2IDI2NSAxNDMgMzUzVDMxNCA0NDJRMzYxIDQ0MiA0MDEgMzk0%0D%0ATDQwNCAzOThRNDA2IDQwMSA0MDkgNDA0VDQxOCA0MTJUNDMxIDQxOVQ0NDcgNDIyUTQ2MSA0MjIg%0D%0ANDcwIDQxM1Q0ODAgMzk0UTQ4MCAzNzkgNDIzIDE1MlQzNjMgLTgwUTM0NSAtMTM0IDI4NiAtMTY5%0D%0AVDE1MSAtMjA1UTEwIC0yMDUgMTAgLTEzN1ExMCAtMTExIDI4IC05MVQ3NCAtNzFRODkgLTcxIDEw%0D%0AMiAtODBUMTE2IC0xMTFRMTE2IC0xMjEgMTE0IC0xMzBUMTA3IC0xNDRUOTkgLTE1NFQ5MiAtMTYy%0D%0ATDkwIC0xNjRIOTFRMTAxIC0xNjcgMTUxIC0xNjdRMTg5IC0xNjcgMjExIC0xNTVRMjM0IC0xNDQg%0D%0AMjU0IC0xMjJUMjgyIC03NVEyODggLTU2IDI5OCAtMTNRMzExIDM1IDMxMSA0M1pNMzg0IDMyOEwz%0D%0AODAgMzM5UTM3NyAzNTAgMzc1IDM1NFQzNjkgMzY4VDM1OSAzODJUMzQ2IDM5M1QzMjggNDAyVDMw%0D%0ANiA0MDVRMjYyIDQwNSAyMjEgMzUyUTE5MSAzMTMgMTcxIDIzM1QxNTEgMTE3UTE1MSAzOCAyMTMg%0D%0AMzhRMjY5IDM4IDMyMyAxMDhMMzMxIDExOEwzODQgMzI4WiI+PC9wYXRoPgo8cGF0aCBzdHJva2Ut%0D%0Ad2lkdGg9IjEiIGlkPSJFMS1NSk1BSU4tMjdFOSIgZD0iTTU1IDczMlE1NiA3MzkgNjEgNzQ0VDc1%0D%0AIDc1MFE4NSA3NTAgOTIgNzQwUTk1IDczMyAxODYgNDk0VDI3OCAyNTBUMTg3IDZUOTIgLTI0MFE4%0D%0ANSAtMjUwIDc1IC0yNTBRNjcgLTI1MCA2MiAtMjQ1VDU1IC0yMzJRNTUgLTIyNyAxNDUgMTFRMjM2%0D%0AIDI0OCAyMzYgMjUwVDE0NSA0ODlRNTUgNzI3IDU1IDczMloiPjwvcGF0aD4KPHBhdGggc3Ryb2tl%0D%0ALXdpZHRoPSIxIiBpZD0iRTEtTUpNQUlOLTdCIiBkPSJNNDM0IC0yMzFRNDM0IC0yNDQgNDI4IC0y%0D%0ANTBINDEwUTI4MSAtMjUwIDIzMCAtMTg0UTIyNSAtMTc3IDIyMiAtMTcyVDIxNyAtMTYxVDIxMyAt%0D%0AMTQ4VDIxMSAtMTMzVDIxMCAtMTExVDIwOSAtODRUMjA5IC00N1QyMDkgMFEyMDkgMjEgMjA5IDUz%0D%0AUTIwOCAxNDIgMjA0IDE1M1EyMDMgMTU0IDIwMyAxNTVRMTg5IDE5MSAxNTMgMjExVDgyIDIzMVE3%0D%0AMSAyMzEgNjggMjM0VDY1IDI1MFQ2OCAyNjZUODIgMjY5UTExNiAyNjkgMTUyIDI4OVQyMDMgMzQ1%0D%0AUTIwOCAzNTYgMjA4IDM3N1QyMDkgNTI5VjU3OVEyMDkgNjM0IDIxNSA2NTZUMjQ0IDY5OFEyNzAg%0D%0ANzI0IDMyNCA3NDBRMzYxIDc0OCAzNzcgNzQ5UTM3OSA3NDkgMzkwIDc0OVQ0MDggNzUwSDQyOFE0%0D%0AMzQgNzQ0IDQzNCA3MzJRNDM0IDcxOSA0MzEgNzE2UTQyOSA3MTMgNDE1IDcxM1EzNjIgNzEwIDMz%0D%0AMiA2ODlUMjk2IDY0N1EyOTEgNjM0IDI5MSA0OTlWNDE3UTI5MSAzNzAgMjg4IDM1M1QyNzEgMzE0%0D%0AUTI0MCAyNzEgMTg0IDI1NUwxNzAgMjUwTDE4NCAyNDVRMjAyIDIzOSAyMjAgMjMwVDI2MiAxOTZU%0D%0AMjkwIDEzN1EyOTEgMTMxIDI5MSAxUTI5MSAtMTM0IDI5NiAtMTQ3UTMwNiAtMTc0IDMzOSAtMTky%0D%0AVDQxNSAtMjEzUTQyOSAtMjEzIDQzMSAtMjE2UTQzNCAtMjE5IDQzNCAtMjMxWiI+PC9wYXRoPgo8%0D%0AcGF0aCBzdHJva2Utd2lkdGg9IjEiIGlkPSJFMS1NSk1BVEhJLTZCIiBkPSJNMTIxIDY0N1ExMjEg%0D%0ANjU3IDEyNSA2NzBUMTM3IDY4M1ExMzggNjgzIDIwOSA2ODhUMjgyIDY5NFEyOTQgNjk0IDI5NCA2%0D%0AODZRMjk0IDY3OSAyNDQgNDc3UTE5NCAyNzkgMTk0IDI3MlEyMTMgMjgyIDIyMyAyOTFRMjQ3IDMw%0D%0AOSAyOTIgMzU0VDM2MiA0MTVRNDAyIDQ0MiA0MzggNDQyUTQ2OCA0NDIgNDg1IDQyM1Q1MDMgMzY5%0D%0AUTUwMyAzNDQgNDk2IDMyN1Q0NzcgMzAyVDQ1NiAyOTFUNDM4IDI4OFE0MTggMjg4IDQwNiAyOTlU%0D%0AMzk0IDMyOFEzOTQgMzUzIDQxMCAzNjlUNDQyIDM5MEw0NTggMzkzUTQ0NiA0MDUgNDM0IDQwNUg0%0D%0AMzBRMzk4IDQwMiAzNjcgMzgwVDI5NCAzMTZUMjI4IDI1NVEyMzAgMjU0IDI0MyAyNTJUMjY3IDI0%0D%0ANlQyOTMgMjM4VDMyMCAyMjRUMzQyIDIwNlQzNTkgMTgwVDM2NSAxNDdRMzY1IDEzMCAzNjAgMTA2%0D%0AVDM1NCA2NlEzNTQgMjYgMzgxIDI2UTQyOSAyNiA0NTkgMTQ1UTQ2MSAxNTMgNDc5IDE1M0g0ODNR%0D%0ANDk5IDE1MyA0OTkgMTQ0UTQ5OSAxMzkgNDk2IDEzMFE0NTUgLTExIDM3OCAtMTFRMzMzIC0xMSAz%0D%0AMDUgMTVUMjc3IDkwUTI3NyAxMDggMjgwIDEyMVQyODMgMTQ1UTI4MyAxNjcgMjY5IDE4M1QyMzQg%0D%0AMjA2VDIwMCAyMTdUMTgyIDIyMEgxODBRMTY4IDE3OCAxNTkgMTM5VDE0NSA4MVQxMzYgNDRUMTI5%0D%0AIDIwVDEyMiA3VDExMSAtMlE5OCAtMTEgODMgLTExUTY2IC0xMSA1NyAtMVQ0OCAxNlE0OCAyNiA4%0D%0ANSAxNzZUMTU4IDQ3MUwxOTUgNjE2UTE5NiA2MjkgMTg4IDYzMlQxNDkgNjM3SDE0NFExMzQgNjM3%0D%0AIDEzMSA2MzdUMTI0IDY0MFQxMjEgNjQ3WiI+PC9wYXRoPgo8cGF0aCBzdHJva2Utd2lkdGg9IjEi%0D%0AIGlkPSJFMS1NSk1BSU4tM0IiIGQ9Ik03OCAzNzBRNzggMzk0IDk1IDQxMlQxMzggNDMwUTE2MiA0%0D%0AMzAgMTgwIDQxNFQxOTkgMzcxUTE5OSAzNDYgMTgyIDMyOFQxMzkgMzEwVDk2IDMyN1Q3OCAzNzBa%0D%0ATTc4IDYwUTc4IDg1IDk0IDEwM1QxMzcgMTIxUTIwMiAxMjEgMjAyIDhRMjAyIC00NCAxODMgLTk0%0D%0AVDE0NCAtMTY5VDExOCAtMTk0UTExNSAtMTk0IDEwNiAtMTg2VDk1IC0xNzRROTQgLTE3MSAxMDcg%0D%0ALTE1NVQxMzcgLTEwN1QxNjAgLTM4UTE2MSAtMzIgMTYyIC0yMlQxNjUgLTRUMTY1IDRRMTY1IDUg%0D%0AMTYxIDRUMTQyIDBRMTEwIDAgOTQgMThUNzggNjBaIj48L3BhdGg+CjxwYXRoIHN0cm9rZS13aWR0%0D%0AaD0iMSIgaWQ9IkUxLU1KTUFJTi0yMjA4IiBkPSJNODQgMjUwUTg0IDM3MiAxNjYgNDUwVDM2MCA1%0D%0AMzlRMzYxIDUzOSAzNzcgNTM5VDQxOSA1NDBUNDY5IDU0MEg1NjhRNTgzIDUzMiA1ODMgNTIwUTU4%0D%0AMyA1MTEgNTcwIDUwMUw0NjYgNTAwUTM1NSA0OTkgMzI5IDQ5NFEyODAgNDgyIDI0MiA0NThUMTgz%0D%0AIDQwOVQxNDcgMzU0VDEyOSAzMDZUMTI0IDI3MlYyNzBINTY4UTU4MyAyNjIgNTgzIDI1MFQ1Njgg%0D%0AMjMwSDEyNFYyMjhRMTI0IDIwNyAxMzQgMTc3VDE2NyAxMTJUMjMxIDQ4VDMyOCA3UTM1NSAxIDQ2%0D%0ANiAwSDU3MFE1ODMgLTEwIDU4MyAtMjBRNTgzIC0zMiA1NjggLTQwSDQ3MVE0NjQgLTQwIDQ0NiAt%0D%0ANDBUNDE3IC00MVEyNjIgLTQxIDE3MiA0NVE4NCAxMjcgODQgMjUwWiI+PC9wYXRoPgo8cGF0aCBz%0D%0AdHJva2Utd2lkdGg9IjEiIGlkPSJFMS1NSkFNUy01QSIgZD0iTTM5IC0xUTI5IDkgMjkgMTJRMjkg%0D%0AMjMgNjAgNzdUMjE5IDMzN0w0MTAgNjQ4SDM2NFEyNjEgNjQ4IDIxMCA2MjhRMTY4IDYxMiAxNDIg%0D%0ANTg4VDEwOSA1NDVUOTcgNTA5VDg4IDQ5MFE4NSA0ODkgODAgNDg5UTcyIDQ4OSA2MSA1MDNMNzAg%0D%0ANTg4UTcyIDYwNyA3NSA2MjhUNzkgNjYyVDgxIDY3NVE4NCA2NzcgODggNjgxUTkwIDY4MyAzNDEg%0D%0ANjgzSDU5MlE2MDQgNjczIDYwNCA2NjZRNjA0IDY2MiA0MTIgMzQ4TDIyMSAzN1EyMjEgMzUgMzAx%0D%0AIDM1UTQwNiAzNSA0NDYgNDhRNTA0IDY4IDU0MyAxMTFUNTk3IDIxMlE2MDIgMjM5IDYxNyAyMzlR%0D%0ANjI0IDIzOSA2MjkgMjM0VDYzNSAyMjNRNjM1IDIxNSA2MjEgMTEzVDYwNCA4TDU5NyAxUTU5NSAt%0D%0AMSAzMTcgLTFIMzlaTTE0OCA2MzdMMTY2IDY0OEgxMTJWNjMyUTExMSA2MjkgMTEwIDYyMlQxMDgg%0D%0ANjEyUTEwOCA2MDggMTEwIDYwOFQxMTYgNjEyVDEyOSA2MjNUMTQ4IDYzN1pNNTUyIDY0NlE1NTIg%0D%0ANjQ4IDUwNCA2NDhRNDUyIDY0OCA0NTAgNjQzUTQ0OCA2MzkgMjY2IDM0M1Q3NyAzN1E3NyAzNSAx%0D%0AMjggMzVIMTc5TDM2NiAzMzlMNTUyIDY0NlpNNTcyIDM1UTU4MSA4OSA1ODEgOTdMNTYxIDc3UTU0%0D%0AMiA1OSA1MjYgNDhMNTA4IDM3TDUzOSAzNUg1NzJaIj48L3BhdGg+CjxwYXRoIHN0cm9rZS13aWR0%0D%0AaD0iMSIgaWQ9IkUxLU1KTUFJTi03RCIgZD0iTTY1IDczMVE2NSA3NDUgNjggNzQ3VDg4IDc1MFEx%0D%0ANzEgNzUwIDIxNiA3MjVUMjc5IDY3MFEyODggNjQ5IDI4OSA2MzVUMjkxIDUwMVEyOTIgMzYyIDI5%0D%0AMyAzNTdRMzA2IDMxMiAzNDUgMjkxVDQxNyAyNjlRNDI4IDI2OSA0MzEgMjY2VDQzNCAyNTBUNDMx%0D%0AIDIzNFQ0MTcgMjMxUTM4MCAyMzEgMzQ1IDIxMFQyOTggMTU3UTI5MyAxNDMgMjkyIDEyMVQyOTEg%0D%0ALTI4Vi03OVEyOTEgLTEzNCAyODUgLTE1NlQyNTYgLTE5OFEyMDIgLTI1MCA4OSAtMjUwUTcxIC0y%0D%0ANTAgNjggLTI0N1Q2NSAtMjMwUTY1IC0yMjQgNjUgLTIyM1Q2NiAtMjE4VDY5IC0yMTRUNzcgLTIx%0D%0AM1E5MSAtMjEzIDEwOCAtMjEwVDE0NiAtMjAwVDE4MyAtMTc3VDIwNyAtMTM5UTIwOCAtMTM0IDIw%0D%0AOSAzTDIxMCAxMzlRMjIzIDE5NiAyODAgMjMwUTMxNSAyNDcgMzMwIDI1MFEzMDUgMjU3IDI4MCAy%0D%0ANzBRMjI1IDMwNCAyMTIgMzUyTDIxMCAzNjJMMjA5IDQ5OFEyMDggNjM1IDIwNyA2NDBRMTk1IDY4%0D%0AMCAxNTQgNjk2VDc3IDcxM1E2OCA3MTMgNjcgNzE2VDY1IDczMVoiPjwvcGF0aD4KPHBhdGggc3Ry%0D%0Ab2tlLXdpZHRoPSIxIiBpZD0iRTEtTUpTWjEtN0IiIGQ9Ik00NzcgLTM0M0w0NzEgLTM0OUg0NThR%0D%0ANDMyIC0zNDkgMzY3IC0zMjVUMjczIC0yNjNRMjU4IC0yNDUgMjUwIC0yMTJMMjQ5IC01MVEyNDkg%0D%0ALTI3IDI0OSAxMlEyNDggMTE4IDI0NCAxMjhRMjQzIDEyOSAyNDMgMTMwUTIyMCAxODkgMTIxIDIy%0D%0AOFExMDkgMjMyIDEwNyAyMzVUMTA1IDI1MFExMDUgMjU2IDEwNSAyNTdUMTA1IDI2MVQxMDcgMjY1%0D%0AVDExMSAyNjhUMTE4IDI3MlQxMjggMjc2VDE0MiAyODNUMTYyIDI5MVEyMjQgMzI0IDI0MyAzNzFR%0D%0AMjQzIDM3MiAyNDQgMzczUTI0OCAzODQgMjQ5IDQ2OVEyNDkgNDc1IDI0OSA0ODlRMjQ5IDUyOCAy%0D%0ANDkgNTUyTDI1MCA3MTRRMjUzIDcyOCAyNTYgNzM2VDI3MSA3NjFUMjk5IDc4OVQzNDcgODE2VDQy%0D%0AMiA4NDNRNDQwIDg0OSA0NDEgODQ5SDQ0M1E0NDUgODQ5IDQ0NyA4NDlUNDUyIDg1MFQ0NTcgODUw%0D%0ASDQ3MUw0NzcgODQ0VjgzMFE0NzcgODIwIDQ3NiA4MTdUNDcwIDgxMVQ0NTkgODA3VDQzNyA4MDFU%0D%0ANDA0IDc4NVEzNTMgNzYwIDMzOCA3MjRRMzMzIDcxMCAzMzMgNTUwUTMzMyA1MjYgMzMzIDQ5MlQz%0D%0AMzQgNDQ3UTMzNCAzOTMgMzI3IDM2OFQyOTUgMzE4UTI1NyAyODAgMTgxIDI1NUwxNjkgMjUxTDE4%0D%0ANCAyNDVRMzE4IDE5OCAzMzIgMTEyUTMzMyAxMDYgMzMzIC00OVEzMzMgLTIwOSAzMzggLTIyM1Ez%0D%0ANTEgLTI1NSAzOTEgLTI3N1Q0NjkgLTMwOVE0NzcgLTMxMSA0NzcgLTMyOVYtMzQzWiI+PC9wYXRo%0D%0APgo8cGF0aCBzdHJva2Utd2lkdGg9IjEiIGlkPSJFMS1NSlNaMS03RCIgZD0iTTExMCA4NDlMMTE1%0D%0AIDg1MFExMjAgODUwIDEyNSA4NTBRMTUxIDg1MCAyMTUgODI2VDMwOSA3NjRRMzI0IDc0NyAzMzIg%0D%0ANzE0TDMzMyA1NTJRMzMzIDUyOCAzMzMgNDg5UTMzNCAzODMgMzM4IDM3M1EzMzkgMzcyIDMzOSAz%0D%0ANzFRMzUzIDMzNiAzOTEgMzEwVDQ2OSAyNzFRNDc3IDI2OCA0NzcgMjUxUTQ3NyAyNDEgNDc2IDIz%0D%0AN1Q0NzIgMjMyVDQ1NiAyMjVUNDI4IDIxNFEzNTcgMTc5IDMzOSAxMzBRMzM5IDEyOSAzMzggMTI4%0D%0AUTMzNCAxMTcgMzMzIDMyUTMzMyAyNiAzMzMgMTJRMzMzIC0yNyAzMzMgLTUxTDMzMiAtMjEyUTMy%0D%0AOCAtMjI4IDMyMyAtMjQwVDMwMiAtMjcxVDI1NSAtMzA3VDE3NSAtMzM4UTEzOSAtMzQ5IDEyNSAt%0D%0AMzQ5VDEwOCAtMzQ2VDEwNSAtMzI5UTEwNSAtMzE0IDEwNyAtMzEyVDEzMCAtMzA0UTIzMyAtMjcx%0D%0AIDI0OCAtMjA5UTI0OSAtMjAzIDI0OSAtNDlWNTdRMjQ5IDEwNiAyNTMgMTI1VDI3MyAxNjdRMzA3%0D%0AIDIxMyAzOTggMjQ1TDQxMyAyNTFMNDAxIDI1NVEyNjUgMzAwIDI1MCAzODlRMjQ5IDM5NSAyNDkg%0D%0ANTUwUTI0OSA3MTAgMjQ0IDcyNFEyMjQgNzc0IDExMiA4MTFRMTA1IDgxMyAxMDUgODMwUTEwNSA4%0D%0ANDUgMTEwIDg0OVoiPjwvcGF0aD4KPC9kZWZzPgo8ZyBzdHJva2U9ImN1cnJlbnRDb2xvciIgZmls%0D%0AbD0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjAiIHRyYW5zZm9ybT0ibWF0cml4KDEgMCAw%0D%0AIC0xIDAgMCkiIGFyaWEtaGlkZGVuPSJ0cnVlIj4KIDx1c2UgeGxpbms6aHJlZj0iI0UxLU1KTUFU%0D%0ASEktNDciIHg9IjAiIHk9IjAiPjwvdXNlPgogPHVzZSB4bGluazpocmVmPSIjRTEtTUpNQUlOLTNE%0D%0AIiB4PSIxMDY0IiB5PSIwIj48L3VzZT4KPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjEyMCwwKSI+%0D%0ACiA8dXNlIHhsaW5rOmhyZWY9IiNFMS1NSk1BSU4tMjdFOCIgeD0iMCIgeT0iMCI+PC91c2U+Cjxn%0D%0AIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM4OSwwKSI+CiA8dXNlIHhsaW5rOmhyZWY9IiNFMS1NSk1B%0D%0AVEhJLTY3IiB4PSIxNjYiIHk9IjAiPjwvdXNlPgo8L2c+CiA8dXNlIHhsaW5rOmhyZWY9IiNFMS1N%0D%0ASk1BSU4tMjdFOSIgeD0iMTIwMyIgeT0iMCI+PC91c2U+CjwvZz4KIDx1c2UgeGxpbms6aHJlZj0i%0D%0AI0UxLU1KTUFJTi0zRCIgeD0iMzk5MSIgeT0iMCI+PC91c2U+CjxnIHRyYW5zZm9ybT0idHJhbnNs%0D%0AYXRlKDUwNDcsMCkiPgogPHVzZSB4bGluazpocmVmPSIjRTEtTUpTWjEtN0IiIHg9IjAiIHk9Ii0x%0D%0AIj48L3VzZT4KPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTgzLDApIj4KIDx1c2UgeGxpbms6aHJl%0D%0AZj0iI0UxLU1KTUFUSEktNjciIHg9IjAiIHk9IjAiPjwvdXNlPgogPHVzZSB0cmFuc2Zvcm09InNj%0D%0AYWxlKDAuNzA3KSIgeGxpbms6aHJlZj0iI0UxLU1KTUFUSEktNkIiIHg9IjY4MCIgeT0iNTgzIj48%0D%0AL3VzZT4KIDx1c2UgeGxpbms6aHJlZj0iI0UxLU1KTUFJTi0zQiIgeD0iOTUwIiB5PSIwIj48L3Vz%0D%0AZT4KIDx1c2UgeGxpbms6aHJlZj0iI0UxLU1KTUFUSEktNkIiIHg9IjE2NzMiIHk9IjAiPjwvdXNl%0D%0APgogPHVzZSB4bGluazpocmVmPSIjRTEtTUpNQUlOLTIyMDgiIHg9IjI0NzIiIHk9IjAiPjwvdXNl%0D%0APgogPHVzZSB4bGluazpocmVmPSIjRTEtTUpBTVMtNUEiIHg9IjM0MTciIHk9IjAiPjwvdXNlPgo8%0D%0AL2c+CiA8dXNlIHhsaW5rOmhyZWY9IiNFMS1NSlNaMS03RCIgeD0iNDY2OCIgeT0iLTEiPjwvdXNl%0D%0APgo8L2c+CjwvZz4KPC9zdmc+)，则称G关于运算“ · ”形成一个**循环群**。

元素的**阶**(order)：

一个群内的一个元素a之阶（有时称为周期）是指会使得am = e的最小正整数m（其中的e为这个群的单位元素，且am为a的m次幂）。若没有此数存在，则称a有无限阶。有限群的所有元素有有限阶。
一个群G的阶被标记为ord(G)或|G|，而一个元素的阶则标记为ord(a)或|a|。

##### 有限域
&emsp;&emsp;在数学中，有限域（finite field）或伽罗瓦域（Galois field，为纪念埃瓦里斯特·伽罗瓦命名）是包含有限个元素的域。与其他域一样，有限域是进行加减乘除运算都有定义并且满足特定规则的集合。有限域最常见的例子是当 p 为素数时，整数对 p 取模。有限域的元素个数称为它的阶(order)。可以看出域是满足更多运算的群。

这里我们规定一个有限域Fp

- 取大质数p，则有限域中有p-1个有限元：0，1，2...p-1
- Fp上的加法为模p加法`a+b≡c(mod p)`
- Fp上的乘法为模p乘法`a×b≡c(mod p)`
- Fp上的除法就是乘除数的乘法逆元`a÷b≡c(mod p)`，即 `a×b^(-1)≡c (mod p)`
- Fp的乘法单位元为1，零元为0
- Fp域上满足交换律，结合律，分配律

&emsp;&emsp;在这个域上我们希望使用椭圆曲线构造加密函数，但是考虑到曲线本身是连续的，不适合做加密，因此我们得想办法在椭圆曲线上构造一种离散的运算。这是我们可以构造一个阿贝尔群：

给定曲线![curve](data:image/svg+xml;base64,PHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjE2%0D%0ALjkzNWV4IiBoZWlnaHQ9IjMuMDA5ZXgiIHN0eWxlPSJ2ZXJ0aWNhbC1hbGlnbjogLTAuNjcxZXg7%0D%0AIiB2aWV3Qm94PSIwIC0xMDA2LjYgNzI5MS40IDEyOTUuNyIgcm9sZT0iaW1nIiBmb2N1c2FibGU9%0D%0AImZhbHNlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGFyaWEtbGFiZWxsZWRi%0D%0AeT0iTWF0aEpheC1TVkctMS1UaXRsZSI+Cjx0aXRsZSBpZD0iTWF0aEpheC1TVkctMS1UaXRsZSI+%0D%0Ae1xkaXNwbGF5c3R5bGUgeV57Mn09eF57M30rYXgrYn08L3RpdGxlPgo8ZGVmcyBhcmlhLWhpZGRl%0D%0Abj0idHJ1ZSI+CjxwYXRoIHN0cm9rZS13aWR0aD0iMSIgaWQ9IkUxLU1KTUFUSEktNzkiIGQ9Ik0y%0D%0AMSAyODdRMjEgMzAxIDM2IDMzNVQ4NCA0MDZUMTU4IDQ0MlExOTkgNDQyIDIyNCA0MTlUMjUwIDM1%0D%0ANVEyNDggMzM2IDI0NyAzMzRRMjQ3IDMzMSAyMzEgMjg4VDE5OCAxOTFUMTgyIDEwNVExODIgNjIg%0D%0AMTk2IDQ1VDIzOCAyN1EyNjEgMjcgMjgxIDM4VDMxMiA2MVQzMzkgOTRRMzM5IDk1IDM0NCAxMTRU%0D%0AMzU4IDE3M1QzNzcgMjQ3UTQxNSAzOTcgNDE5IDQwNFE0MzIgNDMxIDQ2MiA0MzFRNDc1IDQzMSA0%0D%0AODMgNDI0VDQ5NCA0MTJUNDk2IDQwM1E0OTYgMzkwIDQ0NyAxOTNUMzkxIC0yM1EzNjMgLTEwNiAy%0D%0AOTQgLTE1NVQxNTYgLTIwNVExMTEgLTIwNSA3NyAtMTgzVDQzIC0xMTdRNDMgLTk1IDUwIC04MFQ2%0D%0AOSAtNThUODkgLTQ4VDEwNiAtNDVRMTUwIC00NSAxNTAgLTg3UTE1MCAtMTA3IDEzOCAtMTIyVDEx%0D%0ANSAtMTQyVDEwMiAtMTQ3TDk5IC0xNDhRMTAxIC0xNTMgMTE4IC0xNjBUMTUyIC0xNjdIMTYwUTE3%0D%0ANyAtMTY3IDE4NiAtMTY1UTIxOSAtMTU2IDI0NyAtMTI3VDI5MCAtNjVUMzEzIC05VDMyMSAyMUwz%0D%0AMTUgMTdRMzA5IDEzIDI5NiA2VDI3MCAtNlEyNTAgLTExIDIzMSAtMTFRMTg1IC0xMSAxNTAgMTFU%0D%0AMTA0IDgyUTEwMyA4OSAxMDMgMTEzUTEwMyAxNzAgMTM4IDI2MlQxNzMgMzc5UTE3MyAzODAgMTcz%0D%0AIDM4MVExNzMgMzkwIDE3MyAzOTNUMTY5IDQwMFQxNTggNDA0SDE1NFExMzEgNDA0IDExMiAzODVU%0D%0AODIgMzQ0VDY1IDMwMlQ1NyAyODBRNTUgMjc4IDQxIDI3OEgyN1EyMSAyODQgMjEgMjg3WiI+PC9w%0D%0AYXRoPgo8cGF0aCBzdHJva2Utd2lkdGg9IjEiIGlkPSJFMS1NSk1BSU4tMzIiIGQ9Ik0xMDkgNDI5%0D%0AUTgyIDQyOSA2NiA0NDdUNTAgNDkxUTUwIDU2MiAxMDMgNjE0VDIzNSA2NjZRMzI2IDY2NiAzODcg%0D%0ANjEwVDQ0OSA0NjVRNDQ5IDQyMiA0MjkgMzgzVDM4MSAzMTVUMzAxIDI0MVEyNjUgMjEwIDIwMSAx%0D%0ANDlMMTQyIDkzTDIxOCA5MlEzNzUgOTIgMzg1IDk3UTM5MiA5OSA0MDkgMTg2VjE4OUg0NDlWMTg2%0D%0AUTQ0OCAxODMgNDM2IDk1VDQyMSAzVjBINTBWMTlWMzFRNTAgMzggNTYgNDZUODYgODFRMTE1IDEx%0D%0AMyAxMzYgMTM3UTE0NSAxNDcgMTcwIDE3NFQyMDQgMjExVDIzMyAyNDRUMjYxIDI3OFQyODQgMzA4%0D%0AVDMwNSAzNDBUMzIwIDM2OVQzMzMgNDAxVDM0MCA0MzFUMzQzIDQ2NFEzNDMgNTI3IDMwOSA1NzNU%0D%0AMjEyIDYxOVExNzkgNjE5IDE1NCA2MDJUMTE5IDU2OVQxMDkgNTUwUTEwOSA1NDkgMTE0IDU0OVEx%0D%0AMzIgNTQ5IDE1MSA1MzVUMTcwIDQ4OVExNzAgNDY0IDE1NCA0NDdUMTA5IDQyOVoiPjwvcGF0aD4K%0D%0APHBhdGggc3Ryb2tlLXdpZHRoPSIxIiBpZD0iRTEtTUpNQUlOLTNEIiBkPSJNNTYgMzQ3UTU2IDM2%0D%0AMCA3MCAzNjdINzA3UTcyMiAzNTkgNzIyIDM0N1E3MjIgMzM2IDcwOCAzMjhMMzkwIDMyN0g3MlE1%0D%0ANiAzMzIgNTYgMzQ3Wk01NiAxNTNRNTYgMTY4IDcyIDE3M0g3MDhRNzIyIDE2MyA3MjIgMTUzUTcy%0D%0AMiAxNDAgNzA3IDEzM0g3MFE1NiAxNDAgNTYgMTUzWiI+PC9wYXRoPgo8cGF0aCBzdHJva2Utd2lk%0D%0AdGg9IjEiIGlkPSJFMS1NSk1BVEhJLTc4IiBkPSJNNTIgMjg5UTU5IDMzMSAxMDYgMzg2VDIyMiA0%0D%0ANDJRMjU3IDQ0MiAyODYgNDI0VDMyOSAzNzlRMzcxIDQ0MiA0MzAgNDQyUTQ2NyA0NDIgNDk0IDQy%0D%0AMFQ1MjIgMzYxUTUyMiAzMzIgNTA4IDMxNFQ0ODEgMjkyVDQ1OCAyODhRNDM5IDI4OCA0MjcgMjk5%0D%0AVDQxNSAzMjhRNDE1IDM3NCA0NjUgMzkxUTQ1NCA0MDQgNDI1IDQwNFE0MTIgNDA0IDQwNiA0MDJR%0D%0AMzY4IDM4NiAzNTAgMzM2UTI5MCAxMTUgMjkwIDc4UTI5MCA1MCAzMDYgMzhUMzQxIDI2UTM3OCAy%0D%0ANiA0MTQgNTlUNDYzIDE0MFE0NjYgMTUwIDQ2OSAxNTFUNDg1IDE1M0g0ODlRNTA0IDE1MyA1MDQg%0D%0AMTQ1UTUwNCAxNDQgNTAyIDEzNFE0ODYgNzcgNDQwIDMzVDMzMyAtMTFRMjYzIC0xMSAyMjcgNTJR%0D%0AMTg2IC0xMCAxMzMgLTEwSDEyN1E3OCAtMTAgNTcgMTZUMzUgNzFRMzUgMTAzIDU0IDEyM1Q5OSAx%0D%0ANDNRMTQyIDE0MyAxNDIgMTAxUTE0MiA4MSAxMzAgNjZUMTA3IDQ2VDk0IDQxTDkxIDQwUTkxIDM5%0D%0AIDk3IDM2VDExMyAyOVQxMzIgMjZRMTY4IDI2IDE5NCA3MVEyMDMgODcgMjE3IDEzOVQyNDUgMjQ3%0D%0AVDI2MSAzMTNRMjY2IDM0MCAyNjYgMzUyUTI2NiAzODAgMjUxIDM5MlQyMTcgNDA0UTE3NyA0MDQg%0D%0AMTQyIDM3MlQ5MyAyOTBROTEgMjgxIDg4IDI4MFQ3MiAyNzhINThRNTIgMjg0IDUyIDI4OVoiPjwv%0D%0AcGF0aD4KPHBhdGggc3Ryb2tlLXdpZHRoPSIxIiBpZD0iRTEtTUpNQUlOLTMzIiBkPSJNMTI3IDQ2%0D%0AM1ExMDAgNDYzIDg1IDQ4MFQ2OSA1MjRRNjkgNTc5IDExNyA2MjJUMjMzIDY2NVEyNjggNjY1IDI3%0D%0ANyA2NjRRMzUxIDY1MiAzOTAgNjExVDQzMCA1MjJRNDMwIDQ3MCAzOTYgNDIxVDMwMiAzNTBMMjk5%0D%0AIDM0OFEyOTkgMzQ3IDMwOCAzNDVUMzM3IDMzNlQzNzUgMzE1UTQ1NyAyNjIgNDU3IDE3NVE0NTcg%0D%0AOTYgMzk1IDM3VDIzOCAtMjJRMTU4IC0yMiAxMDAgMjFUNDIgMTMwUTQyIDE1OCA2MCAxNzVUMTA1%0D%0AIDE5M1ExMzMgMTkzIDE1MSAxNzVUMTY5IDEzMFExNjkgMTE5IDE2NiAxMTBUMTU5IDk0VDE0OCA4%0D%0AMlQxMzYgNzRUMTI2IDcwVDExOCA2N0wxMTQgNjZRMTY1IDIxIDIzOCAyMVEyOTMgMjEgMzIxIDc0%0D%0AUTMzOCAxMDcgMzM4IDE3NVYxOTVRMzM4IDI5MCAyNzQgMzIyUTI1OSAzMjggMjEzIDMyOUwxNzEg%0D%0AMzMwTDE2OCAzMzJRMTY2IDMzNSAxNjYgMzQ4UTE2NiAzNjYgMTc0IDM2NlEyMDIgMzY2IDIzMiAz%0D%0ANzFRMjY2IDM3NiAyOTQgNDEzVDMyMiA1MjVWNTMzUTMyMiA1OTAgMjg3IDYxMlEyNjUgNjI2IDI0%0D%0AMCA2MjZRMjA4IDYyNiAxODEgNjE1VDE0MyA1OTJUMTMyIDU4MEgxMzVRMTM4IDU3OSAxNDMgNTc4%0D%0AVDE1MyA1NzNUMTY1IDU2NlQxNzUgNTU1VDE4MyA1NDBUMTg2IDUyMFExODYgNDk4IDE3MiA0ODFU%0D%0AMTI3IDQ2M1oiPjwvcGF0aD4KPHBhdGggc3Ryb2tlLXdpZHRoPSIxIiBpZD0iRTEtTUpNQUlOLTJC%0D%0AIiBkPSJNNTYgMjM3VDU2IDI1MFQ3MCAyNzBIMzY5VjQyMEwzNzAgNTcwUTM4MCA1ODMgMzg5IDU4%0D%0AM1E0MDIgNTgzIDQwOSA1NjhWMjcwSDcwN1E3MjIgMjYyIDcyMiAyNTBUNzA3IDIzMEg0MDlWLTY4%0D%0AUTQwMSAtODIgMzkxIC04MkgzODlIMzg3UTM3NSAtODIgMzY5IC02OFYyMzBINzBRNTYgMjM3IDU2%0D%0AIDI1MFoiPjwvcGF0aD4KPHBhdGggc3Ryb2tlLXdpZHRoPSIxIiBpZD0iRTEtTUpNQVRISS02MSIg%0D%0AZD0iTTMzIDE1N1EzMyAyNTggMTA5IDM0OVQyODAgNDQxUTMzMSA0NDEgMzcwIDM5MlEzODYgNDIy%0D%0AIDQxNiA0MjJRNDI5IDQyMiA0MzkgNDE0VDQ0OSAzOTRRNDQ5IDM4MSA0MTIgMjM0VDM3NCA2OFEz%0D%0ANzQgNDMgMzgxIDM1VDQwMiAyNlE0MTEgMjcgNDIyIDM1UTQ0MyA1NSA0NjMgMTMxUTQ2OSAxNTEg%0D%0ANDczIDE1MlE0NzUgMTUzIDQ4MyAxNTNINDg3UTUwNiAxNTMgNTA2IDE0NFE1MDYgMTM4IDUwMSAx%0D%0AMTdUNDgxIDYzVDQ0OSAxM1E0MzYgMCA0MTcgLThRNDA5IC0xMCAzOTMgLTEwUTM1OSAtMTAgMzM2%0D%0AIDVUMzA2IDM2TDMwMCA1MVEyOTkgNTIgMjk2IDUwUTI5NCA0OCAyOTIgNDZRMjMzIC0xMCAxNzIg%0D%0ALTEwUTExNyAtMTAgNzUgMzBUMzMgMTU3Wk0zNTEgMzI4UTM1MSAzMzQgMzQ2IDM1MFQzMjMgMzg1%0D%0AVDI3NyA0MDVRMjQyIDQwNSAyMTAgMzc0VDE2MCAyOTNRMTMxIDIxNCAxMTkgMTI5UTExOSAxMjYg%0D%0AMTE5IDExOFQxMTggMTA2UTExOCA2MSAxMzYgNDRUMTc5IDI2UTIxNyAyNiAyNTQgNTlUMjk4IDEx%0D%0AMFEzMDAgMTE0IDMyNSAyMTdUMzUxIDMyOFoiPjwvcGF0aD4KPHBhdGggc3Ryb2tlLXdpZHRoPSIx%0D%0AIiBpZD0iRTEtTUpNQVRISS02MiIgZD0iTTczIDY0N1E3MyA2NTcgNzcgNjcwVDg5IDY4M1E5MCA2%0D%0AODMgMTYxIDY4OFQyMzQgNjk0UTI0NiA2OTQgMjQ2IDY4NVQyMTIgNTQyUTIwNCA1MDggMTk1IDQ3%0D%0AMlQxODAgNDE4TDE3NiAzOTlRMTc2IDM5NiAxODIgNDAyUTIzMSA0NDIgMjgzIDQ0MlEzNDUgNDQy%0D%0AIDM4MyAzOTZUNDIyIDI4MFE0MjIgMTY5IDM0MyA3OVQxNzMgLTExUTEyMyAtMTEgODIgMjdUNDAg%0D%0AMTUwVjE1OVE0MCAxODAgNDggMjE3VDk3IDQxNFExNDcgNjExIDE0NyA2MjNUMTA5IDYzN1ExMDQg%0D%0ANjM3IDEwMSA2MzdIOTZRODYgNjM3IDgzIDYzN1Q3NiA2NDBUNzMgNjQ3Wk0zMzYgMzI1VjMzMVEz%0D%0AMzYgNDA1IDI3NSA0MDVRMjU4IDQwNSAyNDAgMzk3VDIwNyAzNzZUMTgxIDM1MlQxNjMgMzMwTDE1%0D%0ANyAzMjJMMTM2IDIzNlExMTQgMTUwIDExNCAxMTRRMTE0IDY2IDEzOCA0MlExNTQgMjYgMTc4IDI2%0D%0AUTIxMSAyNiAyNDUgNThRMjcwIDgxIDI4NSAxMTRUMzE4IDIxOVEzMzYgMjkxIDMzNiAzMjVaIj48%0D%0AL3BhdGg+CjwvZGVmcz4KPGcgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIGZpbGw9ImN1cnJlbnRDb2xv%0D%0AciIgc3Ryb2tlLXdpZHRoPSIwIiB0cmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSAwIDApIiBhcmlh%0D%0ALWhpZGRlbj0idHJ1ZSI+CiA8dXNlIHhsaW5rOmhyZWY9IiNFMS1NSk1BVEhJLTc5IiB4PSIwIiB5%0D%0APSIwIj48L3VzZT4KIDx1c2UgdHJhbnNmb3JtPSJzY2FsZSgwLjcwNykiIHhsaW5rOmhyZWY9IiNF%0D%0AMS1NSk1BSU4tMzIiIHg9IjcwNiIgeT0iNTgzIj48L3VzZT4KIDx1c2UgeGxpbms6aHJlZj0iI0Ux%0D%0ALU1KTUFJTi0zRCIgeD0iMTIzMSIgeT0iMCI+PC91c2U+CjxnIHRyYW5zZm9ybT0idHJhbnNsYXRl%0D%0AKDIyODcsMCkiPgogPHVzZSB4bGluazpocmVmPSIjRTEtTUpNQVRISS03OCIgeD0iMCIgeT0iMCI+%0D%0APC91c2U+CiA8dXNlIHRyYW5zZm9ybT0ic2NhbGUoMC43MDcpIiB4bGluazpocmVmPSIjRTEtTUpN%0D%0AQUlOLTMzIiB4PSI4MDkiIHk9IjU4MyI+PC91c2U+CjwvZz4KIDx1c2UgeGxpbms6aHJlZj0iI0Ux%0D%0ALU1KTUFJTi0yQiIgeD0iMzUzNiIgeT0iMCI+PC91c2U+CiA8dXNlIHhsaW5rOmhyZWY9IiNFMS1N%0D%0ASk1BVEhJLTYxIiB4PSI0NTM2IiB5PSIwIj48L3VzZT4KIDx1c2UgeGxpbms6aHJlZj0iI0UxLU1K%0D%0ATUFUSEktNzgiIHg9IjUwNjYiIHk9IjAiPjwvdXNlPgogPHVzZSB4bGluazpocmVmPSIjRTEtTUpN%0D%0AQUlOLTJCIiB4PSI1ODYxIiB5PSIwIj48L3VzZT4KIDx1c2UgeGxpbms6aHJlZj0iI0UxLU1KTUFU%0D%0ASEktNjIiIHg9IjY4NjEiIHk9IjAiPjwvdXNlPgo8L2c+Cjwvc3ZnPg==),P，Q为曲线上的点，我们规定加法：

&emsp;&emsp;实P + Q = R是曲线上点的加法运算，任意取椭圆曲线上两点P、Q（若P、Q两点重合，则作P点的切线），作直线交于椭圆曲线的另一点R'，过R'做y轴的平行线交于R，定义P+Q=R。这样，加法的和也在椭圆曲线上，并同样具备加法的交换律、结合律:

![add](https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/add.png?raw=true)



若P与Q点重合，则求P的切线交曲线的另一点为R‘。若有k个相同的点P相加，如3P = P + P + P

![3p](https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/3p.png?raw=true)

下面我们利用小学二年级就学过的微积分的知识求一下相关方程：

- 无穷远点 O∞是零元，有O∞+ O∞= O∞，O∞+P=P
- P(x,y)的负元是 (x,-y mod p)= (x,p-y) ，有P+(-P)= O∞
- P(x1,y1),Q(x2,y2)的和R(x3,y3) 有如下关系：

```python
x3≡(k**2-x1-x2)(mod p)

y3≡(k(x1-x3)-y1)(mod p)

这里对等式两边求全微分，即可求出k = dy/dx
若P=Q 则 k=((3x**2+a)/2y1)mod p

这里PQ为不同的点，直接计算斜率
若P≠Q，则k=(y2-y1)/(x2-x1) mod p
```

若kP = O ∞ ，那么k就是点P的阶(order)

> 这个就是上面群里元素的阶的定义

上面这个椭圆曲线上点的加法运算，就构成了一个阿贝尔群，数学基础到此结束。

### ElGamal离散对数密码体制

---

&emsp;&emsp;我们来介绍一下基于离散对数的加密算法，首先密钥与公钥的生成步骤如下：

#### 公钥密钥生成：

1. Alice首先构造一条椭圆曲线E，在曲线上选择一点G作为生成元，并求G的阶为n，要求n必须为质数。此时构成了一个循环群\<G>。
2. Alice选择一个私钥k (k < n),生成公钥 Q = kG
3. Alice将公钥组E、Q、G发送给Bob

#### 加密过程

1. Bob收到信息后，将明纹编码为M，M为曲线上一点，并选择一个随机数r（r < n, n为G的阶）
2. Bob计算点Cipher1与Cipher2即两段密文，计算方法如下
   -  Cipher1 = M + rQ
   -  Cipher2 = rG
3. Bob把Cipher1和Cipher2发给Alice

#### 解密过程

1. Alice收到密文后，为了获得M，只需要Cipher1 - k · Cipher2,因为
$$
Cipher1 - k*Cipher2 = M + rQ - krG = M + rkG - krG = M
$$
2. 将M解码即可

#### 技术要求
&emsp;&emsp;在选择参数时有一下要求：

- 大质数p越大安全性越好，但是速度会降低，200位左右可以满足一般安全要求
- n应为质数
- 椭圆曲线上所有点的个数m与n相除的商的整数部分为h，h≤4；p≠n×h ；pt≠1(mod n) (1≤t＜20)
- 满足椭圆曲线的判别式

#### 代码实现
&emsp;&emsp;接下来我们用python写个简单的demo加深一下理解。

解释一下几个基本函数：

这个函数是**扩展欧几里得算法**，就是我们常说的辗转相除法求出最大公因数后反向带入的过程，返回最大公因数a和满足`sa + tb = gcd(a,b)`(这是**贝祖等式**)的s0和t0。gcd(a, b)函数的功能是求a，b的最大公因数。
```python
# Extended GCD
def egcd(a, b):
    s0, s1, t0, t1 = 1, 0, 0, 1
    while b > 0:
        q, r = divmod(a, b)
        a, b = b, r
        s0, s1, t0, t1 = s1, s0 - q * s1, t1, t0 - q * t1
        pass
    return s0, t0, a
```

inv()这个函数实现了求乘法逆元的功能，使用扩展欧几里得算法。

```python
# Get invert element
def inv(n, q):
    # div on ç a/b mod q as a * inv(b, q) mod q
    # n*inv % q = 1 => n*inv = q*m + 1 => n*inv + q*-m = 1
    # => egcd(n, q) = (inv, -m, 1) => inv = egcd(n, q)[0] (mod q)
    return egcd(n, q)[0] % q
```

sqrt()这个函数实现了开平方的算法，需要注意的是这里的乘法运算是有限域上的模乘，因此采用试根的方式。q - i 与 i 构成一对相反数。

```python
def sqrt(n, q):
    # sqrt on PN module: returns two numbers or exception if not exist
    assert n < q
    for i in range(1, q):
        if i * i % q == n:
            return (i, q - i)
        pass
    raise Exception("not found")
```

下面我们构造椭圆曲线类EC：

- 构造函数中a，b为EC的参数，p为模p有限域的大质数
- `is_valid(self, p)`判断点p是否在曲线上
- `at(self, x)`，求出党x为横坐标是对应的y值
- `neg(self, p)`,求关于x轴对称的点
- `add(self, p1, p2)`，求点p1，p2在椭圆曲线上的加法
- `mul(self, p, n)`，把p点累加n次
- `order(self, g)`，求g点的阶

```python
# System of Elliptic Curve
class EC(object):

    # elliptic curve as: (y**2 = x**3 + a * x + b) mod q
    # - a, b: params of curve formula
    # - p: prime number
    def __init__(self, a, b, p):
        assert 0 < a and a < p and 0 < b and b < p and p > 2
        assert (4 * (a ** 3) + 27 * (b ** 2)) % p != 0
        self.a = a
        self.b = b
        self.p = p
        # just as unique ZERO value representation for "add": (not on curve)
        self.zero = Coord(0, 0)
        pass

    # Judge if the coordinate in the curve
    def is_valid(self, p):
        if p == self.zero:
            return True
        l = (p.y ** 2) % self.p
        r = ((p.x ** 3) + self.a * p.x + self.b) % self.p
        return l == r

    def at(self, x):
        # find points on curve at x
        # - x: int < p
        # - returns: ((x, y), (x,-y)) or not found exception

        assert x < self.p
        ysq = (x ** 3 + self.a * x + self.b) % self.p
        y, my = sqrt(ysq, self.p)
        return Coord(x, y), Coord(x, my)

    def neg(self, p):
        # negate p
        return Coord(p.x, -p.y % self.p)

    # 1.无穷远点 O∞是零元，有O∞+ O∞= O∞，O∞+P=P
    # 2.P(x,y)的负元是 (x,-y mod p)= (x,p-y) ，有P+(-P)= O∞
    # 3.P(x1,y1),Q(x2,y2)的和R(x3,y3) 有如下关系：
    # x3≡k**2-x1-x2(mod p)
    # y3≡k(x1-x3)-y1(mod p)
    # 若P=Q 则 k=(3x2+a)/2y1mod p
    # 若P≠Q，则k=(y2-y1)/(x2-x1) mod p
    def add(self, p1, p2):
        # of elliptic curve: negate of 3rd cross point of (p1,p2) line
        if p1 == self.zero:
            return p2
        if p2 == self.zero:
            return p1
        if p1.x == p2.x and (p1.y != p2.y or p1.y == 0):
            # p1 + -p1 == 0
            return self.zero
        if p1.x == p2.x:
            # p1 + p1: use tangent line of p1 as (p1,p1) line
            k = (3 * p1.x * p1.x + self.a) * inv(2 * p1.y, self.p) % self.p
            pass
        else:
            k = (p2.y - p1.y) * inv(p2.x - p1.x, self.p) % self.p
            pass
        x = (k * k - p1.x - p2.x) % self.p
        y = (k * (p1.x - x) - p1.y) % self.p
        return Coord(x, y)

    def mul(self, p, n):
        # n times of elliptic curve
        r = self.zero
        m2 = p
        # O(log2(n)) add
        while 0 < n:
            if n & 1 == 1:
                r = self.add(r, m2)
                pass
            n, m2 = n >> 1, self.add(m2, m2)
            pass
        return r

    def order(self, g):
        # order of point g
        assert self.is_valid(g) and g != self.zero
        for i in range(1, self.p + 1):
            if self.mul(g, i) == self.zero:
                return i
            pass
        raise Exception("Invalid order")
    pass
```

然后我们实现椭圆曲线的加密算法 -- ElGmamal

- 构造函数生成曲线ec，生成元g，以及g的阶n
- `gen(self, priv)`，生成公钥pub
- `enc(self, plain, pub, r)`,把明文plain（已编码为曲线上的点）进行加密
- `dec(self, cipher, priv)`，解密的明文

```python
class ElGamal(object):
    # ElGamal Encryption
    # pub key encryption as replacing (mulmod, powmod) to (ec.add, ec.mul)
    # - ec: elliptic curve
    # - g: (random) a point on ec

    def __init__(self, ec, g):
        assert ec.is_valid(g)
        self.ec = ec
        self.g = g
        self.n = ec.order(g)
        pass

    def gen(self, priv):
        # generate pub key
        # - priv: priv key as (random) int < ec.q
        # - returns: pub key as points on ec

        return self.ec.mul(g, priv)
    
    def check(self, public, recv_public):
        assert public[1] == recv_public[1]
        print("pub == fake_pub")
       
    def enc(self, plain, pub, r):
        # encrypt
        # - plain: data as a point on ec
        # - pub: pub key as points on ec
        # - r: randam int < ec.q
        # - returns: (cipher1, ciper2) as points on ec
        assert self.ec.is_valid(plain)
        assert self.ec.is_valid(pub)
        return (self.ec.mul(self.g, r), self.ec.add(plain, self.ec.mul(pub, r)))

def dec(self, cipher, priv, public, recv_public):
        # decrypt
        # - chiper: (chiper1, chiper2) as points on ec
        # - priv: private key as int < ec.q
        # - returns: plain as a point on ec
        
        self.check(public, recv_public)
        c1, c2 = cipher
        assert self.ec.is_valid(c1) and ec.is_valid(c2)
        return self.ec
```

最后写个main函数验证一下:
```python
if __name__ == "__main__":
    # shared elliptic curve system of examples
    ec = EC(1, 18, 19)
    g, _ = ec.at(7)
    assert ec.order(g) <= ec.p

    # ElGamal enc/dec usage
    eg = ElGamal(ec, g)

    # mapping value to ec point
    # "masking": value k to point ec.mul(g, k)
    # ("imbedding" on proper n:use a point of x as 0 <= n*v <= x < n*(v+1) < q)
    mapping = [ec.mul(g, i) for i in range(eg.n)]
    plain = mapping[7]

    priv = 5
    pub = eg.gen(priv)
    
    cipher = eg.enc(plain, pub, 15)
    decoded = eg.dec(cipher, priv)
    
    assert decoded == plain
    assert cipher != pub
    print("Success!")
```

运行结果如下：

![result](https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/ecc_result.png?raw=true)


### 基于椭圆曲线的数字签名算法ECDSA
---
&emsp;&emsp;签名算法与上面的加密算法类似，下面我们来看一下过程：

1. 选择一条椭圆曲线Ep(a,b)，和基点G；
2. 选择私有密钥k（k<n，n为G的阶），利用基点G计算公开密钥`Q=kG`；
3. 产生一个随机整数r（r<n），计算点`R=rG`；
4. 密文为message，计算SHA1(message)做为hash；
5. 计算`S≡r^-1 *( Hash + k * R.x)(mod n)`; 这里的R.x为R的横坐标
6. (R.x, S)做为签名值，如果R和S其中一个为0，重新从第3步开始执行

> 注：这里的`r^-1`指的是r的乘法逆元

验证签名：
1. 接收方在收到消息m和签名值(R.x, S)后，进行以下运算
2. 计算明文hash：`hash = SHA1(m)`
3. 计算P点：`P = S^-1 *(hash*G + R.x*Q)`
4. 若P点的横坐标P.x == R.x,则说明校验成功。

**为什么会这样？**
下面我们来推导一下：

$$
P = S^-1 * (hash*G + R.x*Q) ·····1
$$
$$
Q = k*G	·····2
$$
$$
S = r^-1 *(hash + k*R.x)	·····3
$$
$$
R = r*G	·····4
$$
联立1，2,得:
$$
P = S^-1 * (hash + k*R.x)*G	·····5
$$
这时候将3式带入5，即可得：
$$
P = r*G    ·····6
$$
这个时候我们对比4，6式，发现了这个神奇的结论：
$$
P = R
$$
因此，在校验的时候比较P.x与R.x即可验证签名


&emsp;&emsp;我们已经完成数学上的推导，下面我们写个demo实现一下：

- 构造函数初始化椭圆曲线EC，生成元g，生成元的阶n
- `gen(self, priv)`生成公钥Q
- `sign(self, hashval, priv, r)`对hashval进行签名，返回签名(R.x, S)
- `validate(self, hashval, sig, pub)`对签名进行验证，检验hashval是否被篡改


```python
class DSA(object):
    # ECDSA
    # - ec: elliptic curve
    # - g: a point on ec
    
    def __init__(self, ec, g):
        self.ec = ec
        self.g = g
        self.n = ec.order(g)
        pass
    
    def gen(self, priv):
        # generate pub key
        assert 0 < priv and priv < self.n
        return self.ec.mul(self.g, priv)
    
    def sign(self, hashval, priv, r):
        # generate signature
        # - hashval: hash value of message as int
        # - priv: priv key as int
        # - r: random int 
        # - returns: signature as (int, int)
    
        assert 0 < r and r < self.n
        R = self.ec.mul(self.g, r)
        # (R.x, S)	S = r^-1 * (hashval + R.x * k)
        return (R.x, inv(r, self.n) * (hashval + R.x * priv) % self.n)
    
    def validate(self, hashval, sig, pub):
        # validate signature
        # - hashval: hash value of message as int
        # - sig: signature as (int, int)
        # - pub: pub key as a point on ec
        
        assert self.ec.is_valid(pub)
        assert self.ec.mul(pub, self.n) == self.ec.zero
        # w = S^-1
        w = inv(sig[1], self.n)
        u1, u2 = hashval * w % self.n, sig[0] * w % self.n
        p = self.ec.add(self.ec.mul(self.g, u1), self.ec.mul(pub, u2))
        return p.x % self.n == sig[0]
    pass
```

我们跑一下下面这段代码试试：
```python
if __name__ == "__main__":
    # shared elliptic curve system of examples
    ec = EC(1, 18, 19)
    g, _ = ec.at(7)
    assert ec.order(g) <= ec.q

		# ECDSA usage
		dsa = DSA(ec, g)
	
		priv = 11
		pub = eg.gen(priv)
		hashval = 128
		r = 7
		sig = dsa.sign(hashval, priv, r)
		log("sig", sig)
		assert dsa.validate(hashval, sig, pub)
		print('Success!')
	pass
```

![sign](https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/sign.png?raw=true)

我们可以看到已经验证成功了。






## 漏洞复现
---

&emsp;&emsp;终于到了分析漏洞的时候了，这个漏洞导致的原因其实很简单，我们注意到在生成公钥的一部分`Q = k*G`的时候k我们是不知到的，而且求解难度很大。但是我们在签名的时候需要用私钥签名，怎么伪造签名呢？假如在对公钥做校验的时候我们没有检测G的值，只检查了Q那么我么就可以假装我们知道私钥。此时：

**这里的e是乘法单位元，相当于整数乘法里的1**
- Q = k*G
- Q' = e*Q = Q


也就是说，我可以直接把“**1**”作为私钥，然后再去签名:

- 公钥：(Q, G)
- 原签名：(R.x，S)

$$
Q = k*G
$$
$$
R = r*Q
$$
$$
S = r^{-1} *(hash + R.x*k)
$$

- 伪造公钥：(Q'，G')
- 伪造签名：(R'.x, S')

$$
Q' = 1*Q = Q
$$
$$
R' = r*Q' = r*Q
$$
$$
S' = r^{-1} *(hash + R'.x*1)
$$

那么我们来分析验证过程：

$$
P = S^{-1} *hash*G + S^{-1} *R.x*Q
$$

假如我们把S‘和R‘.x以及公钥(G', Q)代入后可以得到

$$
S^{-1} = r*(hash + Q.x)^{-1}
$$
$$
P = S^{-1}*(hash*Q + Q.x*Q)
$$
进一步代入S^-1得：
$$
P = r*(hash + Q.x)^{-1} * (hash + Q.x)*Q = r*Q = R
$$

我们看到验证通过。系统在验证公钥得生成元Q == Q‘之后，并没有进一步验证生成元G。这就是**CVE-2020-0601**漏洞利用的原理，crypt32.dll在做校验时，只检查了Q，因此我们用单位元伪造私钥后进行的签名会被验证通过。

&emsp;&emsp;下面我们写个脚本验证一下：

```python
if __name__ == "__main__":
    # shared elliptic curve system of examples
    ec = EC(1, 18, 19)
    g, _ = ec.at(7)
    assert ec.order(g) <= ec.p

    # ECDSA usage
    dsa = DSA(ec, g)
    # G' = Q = k*G
    fake = DSA(ec, ec.mul(g, 11))
    # print(g, ec.mul(g, 1))

    priv = 11
    pub = eg.gen(priv)
    
    # R‘ = r*Q’ = 1 * Q = Q
    # 因此fake_pub = pub
    fake_pub = pub
    log("fake_pub",fake_pub )
    log("pub", pub)

    hashval = 128
    r = 7

    # 随机数r设置为不同的值
    sig = dsa.sign(hashval, priv, 2)
    fsig = fake.sign(hashval, 1, 7)
    log("sig", sig)
    log("fsig", fsig)

    assert sig != fsig

    # 分别进行签名校验
    assert dsa.validate(hashval, sig, pub)
    assert fake.validate(hashval, fsig, fake_pub)
    
    print('Success!')

    pass
```
![sign_result](https://github.com/Explainaur/hexo-blog/blob/master/source/pictures/sign_result.png?raw=true)
&emsp;&emsp;运行结果如下，我们可以看到用不同的私钥加密获得的签名是不同的,但是由于公钥的生成元G被我们篡改，所以验证也会通过。

&emsp;&emsp;最后我们提供一个能用的[poc](https://github.com/ollypwn/cve-2020-0601),仅供学习交流。

## 总结

---

&emsp;&emsp;这个漏洞的原理其实十分简单，就是小学二年级学过的代数。我们应该注意密码的完整性的校验，更要好好学数学。


### 参考

[维基百科](https://zh.wikipedia.org/wiki/ElGamal%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95)

[安全客](https://www.anquanke.com/post/id/159893)
[ECC原理解析](https://www.cnblogs.com/Kalafinaian/p/7392505.html)

